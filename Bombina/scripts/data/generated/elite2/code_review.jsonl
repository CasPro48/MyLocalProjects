{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Java\nVulnerable code:\n```\n\"SELECT * FROM users WHERE id = \" + userId\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Java\n**Severity**: High\n\n**Vulnerable Code**:\n```java\n\"SELECT * FROM users WHERE id = \" + userId\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```java\nPreparedStatement with parameterized query\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Java"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Insecure Deserialization", "input": "Language: Python\nVulnerable code:\n```\npickle.loads(untrusted_data)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Insecure Deserialization\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\npickle.loads(untrusted_data)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Insecure Deserialization because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\njson.loads or validated input\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Insecure Deserialization Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Hardcoded Credentials", "input": "Language: Any\nVulnerable code:\n```\npassword = 'admin123'\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Hardcoded Credentials\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\npassword = 'admin123'\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Hardcoded Credentials because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nEnvironment variables or secrets manager\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Hardcoded Credentials Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix XSS", "input": "Language: JavaScript\nVulnerable code:\n```\nelement.innerHTML = userInput\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: XSS\n**Language**: JavaScript\n**Severity**: High\n\n**Vulnerable Code**:\n```javascript\nelement.innerHTML = userInput\n```\n\n**Issue Analysis**:\nThis code is vulnerable to XSS because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```javascript\nelement.textContent = userInput or proper encoding\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP XSS Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for JavaScript"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Weak Cryptography", "input": "Language: Any\nVulnerable code:\n```\nMD5 or SHA1 for passwords\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Weak Cryptography\n**Language**: Any\n**Severity**: High\n\n**Vulnerable Code**:\n```any\nMD5 or SHA1 for passwords\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Weak Cryptography because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```any\nbcrypt, scrypt, or Argon2\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Weak Cryptography Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Any"}
{"instruction": "Code review: Identify and fix Path Traversal", "input": "Language: Python\nVulnerable code:\n```\nopen(base_dir + user_file)\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Path Traversal\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nopen(base_dir + user_file)\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Path Traversal because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nos.path.join with validation against traversal\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Path Traversal Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix Command Injection", "input": "Language: Python\nVulnerable code:\n```\nos.system(f'ping {host}')\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: Command Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nos.system(f'ping {host}')\n```\n\n**Issue Analysis**:\nThis code is vulnerable to Command Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\nsubprocess.run(['ping', host], shell=False)\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP Command Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
{"instruction": "Code review: Identify and fix SQL Injection", "input": "Language: Python\nVulnerable code:\n```\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```", "output": "**Security Code Review Finding**\n\n**Vulnerability**: SQL Injection\n**Language**: Python\n**Severity**: High\n\n**Vulnerable Code**:\n```python\nf\"SELECT * FROM users WHERE id = {user_input}\"\n```\n\n**Issue Analysis**:\nThis code is vulnerable to SQL Injection because user-controlled input is directly incorporated without proper validation or sanitization.\n\n**Attack Scenario**:\n1. Attacker provides malicious input\n2. Input is processed without sanitization\n3. Vulnerability is triggered\n4. Attacker achieves unauthorized action\n\n**Proof of Concept**:\n```\n# Malicious input example\n[Attack payload demonstrating the vulnerability]\n```\n\n**Remediation**:\n\n**Fixed Code**:\n```python\ncursor.execute(\"SELECT * FROM users WHERE id = ?\", (user_input,))\n```\n\n**Why This Fixes It**:\n- Separates code from data\n- Uses platform security features\n- Validates/sanitizes input\n\n**Additional Recommendations**:\n1. Input validation at entry points\n2. Output encoding at exit points\n3. Principle of least privilege\n4. Defense in depth\n\n**Testing**:\n- Add unit tests for malicious input\n- Include in SAST scanning\n- Manual penetration testing\n\n**References**:\n- OWASP SQL Injection Prevention Cheatsheet\n- CWE-XXX (specific weakness enumeration)\n- Secure coding guidelines for Python"}
