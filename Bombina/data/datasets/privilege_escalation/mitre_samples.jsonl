{"instruction": "Analyze the use of Adversary-in-the-Middle technique in a penetration test.", "input": "Target environment: Linux, macOS, Network Devices, Windows. Attack phase: credential-access, collection. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to position themselves between two or more networked devices using an adversary-in-the-middle (AiTM) technique to support follow-on behaviors such as Network Sniffing, Transmitted Data Manipulation, or replay attacks (Exploitation for Credential Access). By abusing features of common networking protocols that can determine the flow of network traffic (e.g. ARP, DNS, LLMNR, etc.), adversaries may force a device to communicate through an adversary controlled system so they can collect information or perform additional actions. For example, adversaries may manipulate victim DNS settings to enable other malicious activities such as preventing/redirecting users from accessing legitimate sites and/or pushing additional malware. Adversaries may also manipulate DNS and leve This technique serves the credential-access, collection phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Pluggable Authentication Modules technique in a penetration test.", "input": "Target environment: Linux, macOS. Attack phase: credential-access, defense-evasion, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may modify pluggable authentication modules (PAM) to access user credentials or enable otherwise unwarranted access to accounts. PAM is a modular system of configuration files, libraries, and executable files which guide authentication for many services. The most common authentication module is <code>pam_unix.so</code>, which retrieves, sets, and verifies account authentication information in <code>/etc/passwd</code> and <code>/etc/shadow</code>. Adversaries may modify components of the PAM system to create backdoors. PAM components, such as <code>pam_unix.so</code>, can be patched to accept arbitrary adversary supplied values as legitimate credentials. Malicious modifications to the PAM system may also be abused to steal credentials. Adversaries may infect PAM resources with c This technique serves the credential-access, defense-evasion, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Password Guessing technique in a penetration test.", "input": "Target environment: Windows, SaaS, IaaS, Linux, macOS, Containers, Network Devices, Office Suite, Identity Provider, ESXi. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts. Without knowledge of the password for an account, an adversary may opt to systematically guess the password using a repetitive or iterative mechanism. An adversary may guess login credentials without prior knowledge of system or environment passwords during an operation by using a list of common passwords. Password guessing may or may not take into account the target's policies on password complexity or use policies that may lock accounts out after a number of failed attempts. Guessing passwords can be a risky option because it could cause numerous authentication failures and account lockouts, depending on the organization's login failure policie This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of OS Credential Dumping technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password. Credentials can be obtained from OS caches, memory, or structures. Credentials can then be used to perform Lateral Movement and access restricted information. Several of the tools mentioned in associated sub-techniques may be used by both adversaries and professional security testers. Additional custom tools likely exist as well. This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of PowerShell Profile technique in a penetration test.", "input": "Target environment: Windows. Attack phase: privilege-escalation, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may gain persistence and elevate privileges by executing malicious content triggered by PowerShell profiles. A PowerShell profile (<code>profile.ps1</code>) is a script that runs when PowerShell starts and can be used as a logon script to customize user environments. PowerShell supports several profiles depending on the user or host program. For example, there can be different profiles for PowerShell host programs such as the PowerShell console, PowerShell ISE or Visual Studio Code. An administrator can also configure a profile that applies to all users and host programs on the local computer. Adversaries may modify these profiles to include arbitrary commands, functions, modules, and/or PowerShell drives to gain persistence. Every time a user opens a PowerShell session the mod This technique serves the privilege-escalation, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of LC_LOAD_DYLIB Addition technique in a penetration test.", "input": "Target environment: macOS. Attack phase: privilege-escalation, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may establish persistence by executing malicious content triggered by the execution of tainted binaries. Mach-O binaries have a series of headers that are used to perform certain operations when a binary is loaded. The LC_LOAD_DYLIB header in a Mach-O binary tells macOS and OS X which dynamic libraries (dylibs) to load during execution time. These can be added ad-hoc to the compiled binary as long as adjustments are made to the rest of the fields and dependencies. There are tools available to perform these changes. Adversaries may modify Mach-O binary headers to load and execute malicious dylibs every time the binary is executed. Although any changes will invalidate digital signatures on binaries because the binary is being modified, this can be remediated by simply removing th This technique serves the privilege-escalation, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Steal Web Session Cookie technique in a penetration test.", "input": "Target environment: Linux, Office Suite, SaaS, Windows, macOS. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: An adversary may steal web application or service session cookies and use them to gain access to web applications or Internet services as an authenticated user without needing credentials. Web applications and services often use session cookies as an authentication token after a user has authenticated to a website. Cookies are often valid for an extended period of time, even if the web application is not actively used. Cookies can be found on disk, in the process memory of the browser, and in network traffic to remote systems. Additionally, other applications on the targets machine might store sensitive authentication cookies in memory (e.g. apps which authenticate to cloud services). Session cookies can be used to bypasses some multi-factor authentication protocols. There are several exam This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Bypass User Account Control technique in a penetration test.", "input": "Target environment: Windows. Attack phase: privilege-escalation, defense-evasion. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may bypass UAC mechanisms to elevate process privileges on system. Windows User Account Control (UAC) allows a program to elevate its privileges (tracked as integrity levels ranging from low to high) to perform a task under administrator-level permissions, possibly by prompting the user for confirmation. The impact to the user ranges from denying the operation under high enforcement to allowing the user to perform the action if they are in the local administrators group and click through the prompt or allowing them to enter an administrator password to complete the action. If the UAC protection level of a computer is set to anything but the highest level, certain Windows programs can elevate privileges or execute some elevated Component Object Model objects without prompting th This technique serves the privilege-escalation, defense-evasion phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Sudo and Sudo Caching technique in a penetration test.", "input": "Target environment: Linux, macOS. Attack phase: privilege-escalation, defense-evasion. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may perform sudo caching and/or use the sudoers file to elevate privileges. Adversaries may do this to execute commands as other users or spawn processes with higher privileges. Within Linux and MacOS systems, sudo (sometimes referred to as \"superuser do\") allows users to perform commands from terminals with elevated privileges and to control who can perform these commands on the system. The <code>sudo</code> command \"allows a system administrator to delegate authority to give certain users (or groups of users) the ability to run some (or all) commands as root or another user while providing an audit trail of the commands and their arguments.\" Since sudo was made for the system administrator, it has some useful configuration features such as a <code>timestamp_timeout</code>, wh This technique serves the privilege-escalation, defense-evasion phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Security Account Manager technique in a penetration test.", "input": "Target environment: Windows. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to extract credential material from the Security Account Manager (SAM) database either through in-memory techniques or through the Windows Registry where the SAM database is stored. The SAM is a database file that contains local accounts for the host, typically those found with the <code>net user</code> command. Enumerating the SAM database requires SYSTEM level access. A number of tools can be used to retrieve the SAM file through in-memory techniques: * pwdumpx.exe * gsecdump * Mimikatz * secretsdump.py Alternatively, the SAM can be extracted from the Registry with Reg: * <code>reg save HKLM\\sam sam</code> * <code>reg save HKLM\\system system</code> Creddump7 can then be used to process the SAM database locally to retrieve hashes. Notes: * RID 500 account is the lo This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Cloud Instance Metadata API technique in a penetration test.", "input": "Target environment: IaaS. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to access the Cloud Instance Metadata API to collect credentials and other sensitive data. Most cloud service providers support a Cloud Instance Metadata API which is a service provided to running virtual instances that allows applications to access information about the running virtual instance. Available information generally includes name, security group, and additional metadata including sensitive data such as credentials and UserData scripts that may contain additional secrets. The Instance Metadata API is provided as a convenience to assist in managing applications and is accessible by anyone who can access the instance. A cloud metadata API has been used in at least one high profile compromise. If adversaries have a presence on the running virtual instance, t This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Securityd Memory technique in a penetration test.", "input": "Target environment: Linux, macOS. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: An adversary with root access may gather credentials by reading \u2019s memory. is a service/daemon responsible for implementing security protocols such as encryption and authorization. A privileged adversary may be able to scan through 's memory to find the correct sequence of keys to decrypt the user\u2019s logon keychain. This may provide the adversary with various plaintext passwords, such as those for users, WiFi, mail, browsers, certificates, secure notes, etc. In OS X prior to El Capitan, users with root access can read plaintext keychain passwords of logged-in users because Apple\u2019s keychain implementation allows these credentials to be cached so that users are not repeatedly prompted for passwords. Apple\u2019s utility takes the user\u2019s logon password, encrypts it with PBKDF2, and stores this mast This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Password Cracking technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows, Network Devices, Office Suite, Identity Provider. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use password cracking to attempt to recover usable credentials, such as plaintext passwords, when credential material such as password hashes are obtained. OS Credential Dumping can be used to obtain password hashes, this may only get an adversary so far when Pass the Hash is not an option. Further, adversaries may leverage Data from Configuration Repository in order to obtain hashed credentials for network devices. Techniques to systematically guess the passwords used to compute hashes are available, or the adversary may use a pre-computed rainbow table to crack hashes. Cracking hashes is usually done on adversary-controlled systems outside of the target network. The resulting plaintext password resulting from a successfully cracked hash may be used to log into systems, re This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Keychain technique in a penetration test.", "input": "Target environment: macOS. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may acquire credentials from Keychain. Keychain (or Keychain Services) is the macOS credential management system that stores account names, passwords, private keys, certificates, sensitive application data, payment data, and secure notes. There are three types of Keychains: Login Keychain, System Keychain, and Local Items (iCloud) Keychain. The default Keychain is the Login Keychain, which stores user passwords and information. The System Keychain stores items accessed by the operating system, such as items shared among users on a host. The Local Items (iCloud) Keychain is used for items synced with Apple\u2019s iCloud service. Keychains can be viewed and edited through the Keychain Access application or using the command-line utility <code>security</code>. Keychain files are locate This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of LSA Secrets technique in a penetration test.", "input": "Target environment: Windows. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries with SYSTEM access to a host may attempt to access Local Security Authority (LSA) secrets, which can contain a variety of different credential materials, such as credentials for service accounts. LSA secrets are stored in the registry at <code>HKEY_LOCAL_MACHINE\\SECURITY\\Policy\\Secrets</code>. LSA secrets can also be dumped from memory. Reg can be used to extract from the Registry. Mimikatz can be used to extract secrets from memory. This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of SAML Tokens technique in a penetration test.", "input": "Target environment: SaaS, Windows, IaaS, Office Suite, Identity Provider. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: An adversary may forge SAML tokens with any permissions claims and lifetimes if they possess a valid SAML token-signing certificate. The default lifetime of a SAML token is one hour, but the validity period can be specified in the <code>NotOnOrAfter</code> value of the <code>conditions ...</code> element in a token. This value can be changed using the <code>AccessTokenLifetime</code> in a <code>LifetimeTokenPolicy</code>. Forged SAML tokens enable adversaries to authenticate across services that use SAML 2.0 as an SSO (single sign-on) mechanism. An adversary may utilize Private Keys to compromise an organization's token-signing certificate to create forged SAML tokens. If the adversary has sufficient permissions to establish a new federation trust with their own Active Directory Federation This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Proc Filesystem technique in a penetration test.", "input": "Target environment: Linux. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may gather credentials from the proc filesystem or . The proc filesystem is a pseudo-filesystem used as an interface to kernel data structures for Linux based systems managing virtual memory. For each process, the file shows how memory is mapped within the process\u2019s virtual address space. And , exposed for debugging purposes, provides access to the process\u2019s virtual address space. When executing with root privileges, adversaries can search these memory locations for all processes on a system that contain patterns indicative of credentials. Adversaries may use regex patterns, such as <code>grep -E \"^[0-9a-f-]* r\" /proc/\"$pid\"/maps | cut -d' ' -f 1</code>, to look for fixed strings in memory structures or cached hashes. When running without privileged access, processes can still  This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Password Managers technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may acquire user credentials from third-party password managers. Password managers are applications designed to store user credentials, normally in an encrypted database. Credentials are typically accessible after a user provides a master password that unlocks the database. After the database is unlocked, these credentials may be copied to memory. These databases can be stored as files on disk. Adversaries may acquire user credentials from password managers by extracting the master password and/or plain-text credentials from memory. Adversaries may extract credentials from memory via Exploitation for Credential Access. Adversaries may also try brute forcing via Password Guessing to obtain the master password of a password manager. This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Network Sniffing technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows, Network Devices, IaaS. Attack phase: credential-access, discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may passively sniff network traffic to capture information about an environment, including authentication material passed over the network. Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection. An adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data. Data captured via this technique may include user credentials, especially those sent over an insecure, unencrypted protocol. Techniques for name service resolution poisoning, such as LLMNR/NBT-NS Poisoning and SMB Relay, can also be used to capture credentials to websites, proxies, and internal systems by redirecting traffic to an This technique serves the credential-access, discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Credentials in Registry technique in a penetration test.", "input": "Target environment: Windows. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may search the Registry on compromised systems for insecurely stored credentials. The Windows Registry stores configuration information that can be used by the system or other programs. Adversaries may query the Registry looking for credentials and passwords that have been stored for use by other programs or services. Sometimes these credentials are used for automatic logons. Example commands to find Registry keys related to password information: * Local Machine Hive: <code>reg query HKLM /f password /t REG_SZ /s</code> * Current User Hive: <code>reg query HKCU /f password /t REG_SZ /s</code> This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Password Filter DLL technique in a penetration test.", "input": "Target environment: Windows. Attack phase: credential-access, defense-evasion, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may register malicious password filter dynamic link libraries (DLLs) into the authentication process to acquire user credentials as they are validated. Windows password filters are password policy enforcement mechanisms for both domain and local accounts. Filters are implemented as DLLs containing a method to validate potential passwords against password policies. Filter DLLs can be positioned on local computers for local accounts and/or domain controllers for domain accounts. Before registering new passwords in the Security Accounts Manager (SAM), the Local Security Authority (LSA) requests validation from each registered filter. Any potential changes cannot take effect until every registered filter acknowledges validation. Adversaries can register malicious password filters t This technique serves the credential-access, defense-evasion, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Ccache Files technique in a penetration test.", "input": "Target environment: Linux, macOS. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to steal Kerberos tickets stored in credential cache files (or ccache). These files are used for short term storage of a user's active session credentials. The ccache file is created upon user authentication and allows for access to multiple services without the user having to re-enter credentials. The <code>/etc/krb5.conf</code> configuration file and the <code>KRB5CCNAME</code> environment variable are used to set the storage location for ccache entries. On Linux, credentials are typically stored in the directory with a naming format of or . On macOS, ccache entries are stored by default in memory with an naming scheme. Typically, users interact with ticket storage using <code>kinit</code>, which obtains a Ticket-Granting-Ticket (TGT) for the principal; <code>klis This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of AS-REP Roasting technique in a penetration test.", "input": "Target environment: Windows. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may reveal credentials of accounts that have disabled Kerberos preauthentication by Password Cracking Kerberos messages. Preauthentication offers protection against offline Password Cracking. When enabled, a user requesting access to a resource initiates communication with the Domain Controller (DC) by sending an Authentication Server Request (AS-REQ) message with a timestamp that is encrypted with the hash of their password. If and only if the DC is able to successfully decrypt the timestamp with the hash of the user\u2019s password, it will then send an Authentication Server Response (AS-REP) message that contains the Ticket Granting Ticket (TGT) to the user. Part of the AS-REP message is signed with the user\u2019s password. For each account found without preauthentication, an adversa This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Steal or Forge Kerberos Tickets technique in a penetration test.", "input": "Target environment: Windows, Linux, macOS. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to subvert Kerberos authentication by stealing or forging Kerberos tickets to enable Pass the Ticket. Kerberos is an authentication protocol widely used in modern Windows domain environments. In Kerberos environments, referred to as \u201crealms\u201d, there are three basic participants: client, service, and Key Distribution Center (KDC). Clients request access to a service and through the exchange of Kerberos tickets, originating from KDC, they are granted access after having successfully authenticated. The KDC is responsible for both authentication and ticket granting. Adversaries may attempt to abuse Kerberos by stealing tickets or forging tickets to enable unauthorized access. On Windows, the built-in <code>klist</code> utility can be used to list and analyze cached Kerbe This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Credentials from Password Stores technique in a penetration test.", "input": "Target environment: IaaS, Linux, macOS, Windows. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may search for common password storage locations to obtain user credentials. Passwords are stored in several places on a system, depending on the operating system or application holding the credentials. There are also specific applications and services that store passwords to make them easier for users to manage and maintain, such as password managers and cloud secrets vaults. Once credentials are obtained, they can be used to perform lateral movement and access restricted information. This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Application Shimming technique in a penetration test.", "input": "Target environment: Windows. Attack phase: privilege-escalation, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by application shims. The Microsoft Windows Application Compatibility Infrastructure/Framework (Application Shim) was created to allow for backward compatibility of software as the operating system codebase changes over time. For example, the application shimming feature allows developers to apply fixes to applications (without rewriting code) that were created for Windows XP so that it will work with Windows 10. Within the framework, shims are created to act as a buffer between the program (or more specifically, the Import Address Table) and the Windows OS. When a program is executed, the shim cache is referenced to determine if the program requires the use of the shim database (.sdb). This technique serves the privilege-escalation, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Unsecured Credentials technique in a penetration test.", "input": "Target environment: Windows, SaaS, IaaS, Linux, macOS, Containers, Network Devices, Office Suite, Identity Provider. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may search compromised systems to find and obtain insecurely stored credentials. These credentials can be stored and/or misplaced in many locations on a system, including plaintext files (e.g. Shell History), operating system or application-specific repositories (e.g. Credentials in Registry), or other specialized files/artifacts (e.g. Private Keys). This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Evil Twin technique in a penetration test.", "input": "Target environment: Network Devices. Attack phase: credential-access, collection. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may host seemingly genuine Wi-Fi access points to deceive users into connecting to malicious networks as a way of supporting follow-on behaviors such as Network Sniffing, Transmitted Data Manipulation, or Input Capture. By using a Service Set Identifier (SSID) of a legitimate Wi-Fi network, fraudulent Wi-Fi access points may trick devices or users into connecting to malicious Wi-Fi networks. Adversaries may provide a stronger signal strength or block access to Wi-Fi access points to coerce or entice victim devices into connecting to malicious networks. A Wi-Fi Pineapple \u2013 a network security auditing and penetration testing tool \u2013 may be deployed in Evil Twin attacks for ease of use and broader range. Custom certificates may be used in an attempt to intercept HTTPS traffic. Simi This technique serves the credential-access, collection phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Escape to Host technique in a penetration test.", "input": "Target environment: Windows, Linux, Containers, ESXi. Attack phase: privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may break out of a container or virtualized environment to gain access to the underlying host. This can allow an adversary access to other containerized or virtualized resources from the host level or to the host itself. In principle, containerized / virtualized resources should provide a clear separation of application functionality and be isolated from the host environment. There are multiple ways an adversary may escape from a container to a host environment. Examples include creating a container configured to mount the host\u2019s filesystem using the bind parameter, which allows the adversary to drop payloads and execute control utilities such as cron on the host; utilizing a privileged container to run commands or load a malicious kernel module on the underlying host; or abusi This technique serves the privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Hybrid Identity technique in a penetration test.", "input": "Target environment: Windows, SaaS, IaaS, Office Suite, Identity Provider. Attack phase: credential-access, defense-evasion, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may patch, modify, or otherwise backdoor cloud authentication processes that are tied to on-premises user identities in order to bypass typical authentication mechanisms, access credentials, and enable persistent access to accounts. Many organizations maintain hybrid user and device identities that are shared between on-premises and cloud-based environments. These can be maintained in a number of ways. For example, Microsoft Entra ID includes three options for synchronizing identities between Active Directory and Entra ID: * Password Hash Synchronization (PHS), in which a privileged on-premises account synchronizes user password hashes between Active Directory and Entra ID, allowing authentication to Entra ID to take place entirely in the cloud * Pass Through Authentication (PT This technique serves the credential-access, defense-evasion, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Credentials from Web Browsers technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may acquire credentials from web browsers by reading files specific to the target browser. Web browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future. Web browsers typically store the credentials in an encrypted format within a credential store; however, methods exist to extract plaintext credentials from web browsers. For example, on Windows systems, encrypted credentials may be obtained from Google Chrome by reading a database file, <code>AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data</code> and executing a SQL query: <code>SELECT action_url, username_value, password_value FROM logins;</code>. The plaintext password can then be obtained by passing the encrypted credentials to the Windo This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of DHCP Spoofing technique in a penetration test.", "input": "Target environment: Linux, Windows, macOS. Attack phase: credential-access, collection. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may redirect network traffic to adversary-owned systems by spoofing Dynamic Host Configuration Protocol (DHCP) traffic and acting as a malicious DHCP server on the victim network. By achieving the adversary-in-the-middle (AiTM) position, adversaries may collect network communications, including passed credentials, especially those sent over insecure, unencrypted protocols. This may also enable follow-on behaviors such as Network Sniffing or Transmitted Data Manipulation. DHCP is based on a client-server model and has two functionalities: a protocol for providing network configuration settings from a DHCP server to a client and a mechanism for allocating network addresses to clients. The typical server-client interaction is as follows: 1. The client broadcasts a message. 2. The  This technique serves the credential-access, collection phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Private Keys technique in a penetration test.", "input": "Target environment: Linux, macOS, Network Devices, Windows. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may search for private key certificate files on compromised systems for insecurely stored credentials. Private cryptographic keys and certificates are used for authentication, encryption/decryption, and digital signatures. Common key and certificate file extensions include: .key, .pgp, .gpg, .ppk., .p12, .pem, .pfx, .cer, .p7b, .asc. Adversaries may also look in common key directories, such as <code>~/.ssh</code> for SSH keys on * nix-based systems or <code>C:&#92;Users&#92;(username)&#92;.ssh&#92;</code> on Windows. Adversary tools may also search compromised systems for file extensions relating to cryptographic keys and certificates. When a device is registered to Entra ID, a device key and a transport key are generated and used to verify the device\u2019s identity. An adversary w This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Trap technique in a penetration test.", "input": "Target environment: macOS, Linux. Attack phase: privilege-escalation, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may establish persistence by executing malicious content triggered by an interrupt signal. The <code>trap</code> command allows programs and shells to specify commands that will be executed upon receiving interrupt signals. A common situation is a script allowing for graceful termination and handling of common keyboard interrupts like <code>ctrl+c</code> and <code>ctrl+d</code>. Adversaries can use this to register code to be executed when the shell encounters specific interrupts as a persistence mechanism. Trap commands are of the following format <code>trap 'command list' signals</code> where \"command list\" will be executed when \"signals\" are received. This technique serves the privilege-escalation, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of LLMNR/NBT-NS Poisoning and SMB Relay technique in a penetration test.", "input": "Target environment: Windows. Attack phase: credential-access, collection. Assume standard enterprise security controls are in place.", "output": "Technique overview: By responding to LLMNR/NBT-NS network traffic, adversaries may spoof an authoritative source for name resolution to force communication with an adversary controlled system. This activity may be used to collect or relay authentication materials. Link-Local Multicast Name Resolution (LLMNR) and NetBIOS Name Service (NBT-NS) are Microsoft Windows components that serve as alternate methods of host identification. LLMNR is based upon the Domain Name System (DNS) format and allows hosts on the same local link to perform name resolution for other hosts. NBT-NS identifies systems on a local network by their NetBIOS name. Adversaries can spoof an authoritative source for name resolution on a victim network by responding to LLMNR (UDP 5355)/NBT-NS (UDP 137) traffic as if they know the identity of th This technique serves the credential-access, collection phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of LSASS Memory technique in a penetration test.", "input": "Target environment: Windows. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to access credential material stored in the process memory of the Local Security Authority Subsystem Service (LSASS). After a user logs on, the system generates and stores a variety of credential materials in LSASS process memory. These credential materials can be harvested by an administrative user or SYSTEM and used to conduct Lateral Movement using Use Alternate Authentication Material. As well as in-memory techniques, the LSASS process memory can be dumped from the target host and analyzed on a local system. For example, on the target host use procdump: * <code>procdump -ma lsass.exe lsass_dump</code> Locally, mimikatz can be run using: * <code>sekurlsa::Minidump lsassdump.dmp</code> * <code>sekurlsa::logonPasswords</code> Built-in Windows tools such as can also This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Abuse Elevation Control Mechanism technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows, IaaS, Office Suite, Identity Provider. Attack phase: privilege-escalation, defense-evasion. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may circumvent mechanisms designed to control elevate privileges to gain higher-level permissions. Most modern systems contain native elevation control mechanisms that are intended to limit privileges that a user can perform on a machine. Authorization has to be granted to specific users in order to perform tasks that can be considered of higher risk. An adversary can perform several methods to take advantage of built-in control mechanisms in order to escalate privileges on a system. This technique serves the privilege-escalation, defense-evasion phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Setuid and Setgid technique in a penetration test.", "input": "Target environment: Linux, macOS. Attack phase: privilege-escalation, defense-evasion. Assume standard enterprise security controls are in place.", "output": "Technique overview: An adversary may abuse configurations where an application has the setuid or setgid bits set in order to get code running in a different (and possibly more privileged) user\u2019s context. On Linux or macOS, when the setuid or setgid bits are set for an application binary, the application will run with the privileges of the owning user or group respectively. Normally an application is run in the current user\u2019s context, regardless of which user or group owns the application. However, there are instances where programs need to be executed in an elevated context to function properly, but the user running them may not have the specific required privileges. Instead of creating an entry in the sudoers file, which must be done by root, any user can specify the setuid or setgid flag to be set for their This technique serves the privilege-escalation, defense-evasion phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Password Spraying technique in a penetration test.", "input": "Target environment: Containers, ESXi, IaaS, Identity Provider, Linux, Network Devices, Office Suite, SaaS, Windows, macOS. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials. Password spraying uses one password (e.g. 'Password01'), or a small list of commonly used passwords, that may match the complexity policy of the domain. Logins are attempted with that password against many different accounts on a network to avoid account lockouts that would normally occur when brute forcing a single account with many passwords. Typically, management services over commonly used ports are used when password spraying. Commonly targeted services include the following: * SSH (22/TCP) * Telnet (23/TCP) * FTP (21/TCP) * NetBIOS / SMB / Samba (139/TCP & 445/TCP) * LDAP (389/TCP) * Kerberos (88/TCP) * RDP / Terminal Services (3389/TC This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Cached Domain Credentials technique in a penetration test.", "input": "Target environment: Windows, Linux. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to access cached domain credentials used to allow authentication to occur in the event a domain controller is unavailable. On Windows Vista and newer, the hash format is DCC2 (Domain Cached Credentials version 2) hash, also known as MS-Cache v2 hash. The number of default cached credentials varies and can be altered per system. This hash does not allow pass-the-hash style attacks, and instead requires Password Cracking to recover the plaintext password. On Linux systems, Active Directory credentials can be accessed through caches maintained by software like System Security Services Daemon (SSSD) or Quest Authentication Services (formerly VAS). Cached credential hashes are typically located at for SSSD or for Quest. Adversaries can use utilities, such as , on these d This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Image File Execution Options Injection technique in a penetration test.", "input": "Target environment: Windows. Attack phase: privilege-escalation, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by Image File Execution Options (IFEO) debuggers. IFEOs enable a developer to attach a debugger to an application. When a process is created, a debugger present in an application\u2019s IFEO will be prepended to the application\u2019s name, effectively launching the new process under the debugger (e.g., <code>C:\\dbg\\ntsd.exe -g notepad.exe</code>). IFEOs can be set directly via the Registry or in Global Flags via the GFlags tool. IFEOs are represented as <code>Debugger</code> values in the Registry under <code>HKLM\\SOFTWARE{\\Wow6432Node}\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\<executable></code> where <code>&lt;executable&gt;</code> is the binary on which the debugger is This technique serves the privilege-escalation, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Temporary Elevated Cloud Access technique in a penetration test.", "input": "Target environment: IaaS, Office Suite, Identity Provider. Attack phase: privilege-escalation, defense-evasion. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse permission configurations that allow them to gain temporarily elevated access to cloud resources. Many cloud environments allow administrators to grant user or service accounts permission to request just-in-time access to roles, impersonate other accounts, pass roles onto resources and services, or otherwise gain short-term access to a set of privileges that may be distinct from their own. Just-in-time access is a mechanism for granting additional roles to cloud accounts in a granular, temporary manner. This allows accounts to operate with only the permissions they need on a daily basis, and to request additional permissions as necessary. Sometimes just-in-time access requests are configured to require manual approval, while other times the desired permissions are aut This technique serves the privilege-escalation, defense-evasion phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Accessibility Features technique in a penetration test.", "input": "Target environment: Windows. Attack phase: privilege-escalation, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by accessibility features. Windows contains accessibility features that may be launched with a key combination before a user has logged in (ex: when the user is on the Windows logon screen). An adversary can modify the way these programs are launched to get a command prompt or backdoor without logging in to the system. Two common accessibility programs are <code>C:\\Windows\\System32\\sethc.exe</code>, launched when the shift key is pressed five times and <code>C:\\Windows\\System32\\utilman.exe</code>, launched when the Windows + U key combination is pressed. The sethc.exe program is often referred to as \"sticky keys\", and has been used by adversaries for unauthenticated access through a rem This technique serves the privilege-escalation, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Golden Ticket technique in a penetration test.", "input": "Target environment: Windows. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries who have the KRBTGT account password hash may forge Kerberos ticket-granting tickets (TGT), also known as a golden ticket. Golden tickets enable adversaries to generate authentication material for any account in Active Directory. Using a golden ticket, adversaries are then able to request ticket granting service (TGS) tickets, which enable access to specific resources. Golden tickets require adversaries to interact with the Key Distribution Center (KDC) in order to obtain TGS. The KDC service runs all on domain controllers that are part of an Active Directory domain. KRBTGT is the Kerberos Key Distribution Center (KDC) service account and is responsible for encrypting and signing all Kerberos tickets. The KRBTGT password hash may be obtained using OS Credential Dumping and priv This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of AppCert DLLs technique in a penetration test.", "input": "Target environment: Windows. Attack phase: privilege-escalation, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by AppCert DLLs loaded into processes. Dynamic-link libraries (DLLs) that are specified in the <code>AppCertDLLs</code> Registry key under <code>HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\</code> are loaded into every process that calls the ubiquitously used application programming interface (API) functions <code>CreateProcess</code>, <code>CreateProcessAsUser</code>, <code>CreateProcessWithLoginW</code>, <code>CreateProcessWithTokenW</code>, or <code>WinExec</code>. Similar to Process Injection, this value can be abused to obtain elevated privileges by causing a malicious DLL to be loaded and run in the context of separate processes on the computer. Malicious A This technique serves the privilege-escalation, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Steal or Forge Authentication Certificates technique in a penetration test.", "input": "Target environment: Windows, Linux, macOS, Identity Provider. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may steal or forge certificates used for authentication to access remote systems or resources. Digital certificates are often used to sign and encrypt messages and/or files. Certificates are also used as authentication material. For example, Entra ID device certificates and Active Directory Certificate Services (AD CS) certificates bind to an identity and can be used as credentials for domain accounts. Authentication certificates can be both stolen and forged. For example, AD CS certificates can be stolen from encrypted storage (in the Registry or files), misplaced certificate files (i.e. Unsecured Credentials), or directly from the Windows certificate store via various crypto APIs. With appropriate enrollment rights, users and/or machines within a domain can also request and/o This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Shell History technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may search the command history on compromised systems for insecurely stored credentials. On Linux and macOS systems, shells such as Bash and Zsh keep track of the commands users type on the command-line with the \"history\" utility. Once a user logs out, the history is flushed to the user's history file. For each user, this file resides at the same location: for example, or . Typically, these files keeps track of the user's last 1000 commands. On Windows, PowerShell has both a command history that is wiped after the session ends, and one that contains commands used in all sessions and is persistent. The default location for persistent history can be found in , but command history can also be accessed with . Command Prompt (CMD) on Windows does not have persistent history. Users o This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Credentials In Files technique in a penetration test.", "input": "Target environment: Containers, IaaS, Linux, macOS, Windows. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may search local file systems and remote file shares for files containing insecurely stored credentials. These can be files created by users to store their own credentials, shared credential stores for a group of individuals, configuration files containing passwords for a system or service, or source code/binary files containing embedded passwords. It is possible to extract passwords from backups or saved virtual machines through OS Credential Dumping. Passwords may also be obtained from Group Policy Preferences stored on the Windows Domain Controller. In cloud and/or containerized environments, authenticated user and service account credentials are often stored in local configuration and credential files. They may also be found as parameters to deployment commands in container This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Web Cookies technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows, SaaS, IaaS. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may forge web cookies that can be used to gain access to web applications or Internet services. Web applications and services (hosted in cloud SaaS environments or on-premise servers) often use session cookies to authenticate and authorize user access. Adversaries may generate these cookies in order to gain access to web resources. This differs from Steal Web Session Cookie and other similar behaviors in that the cookies are new and forged by the adversary, rather than stolen or intercepted from legitimate users. Most common web applications have standardized and documented cookie values that can be generated using provided tools or interfaces. The generation of web cookies often requires secret values, such as passwords, Private Keys, or other cryptographic seed values. Once f This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Steal Application Access Token technique in a penetration test.", "input": "Target environment: SaaS, Containers, IaaS, Office Suite, Identity Provider. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries can steal application access tokens as a means of acquiring credentials to access remote systems and resources. Application access tokens are used to make authorized API requests on behalf of a user or service and are commonly used as a way to access resources in cloud and container-based applications and software-as-a-service (SaaS). Adversaries who steal account API tokens in cloud and containerized environments may be able to access data and perform actions with the permissions of these accounts, which can lead to privilege escalation and further compromise of the environment. For example, in Kubernetes environments, processes running inside a container may communicate with the Kubernetes API server using service account tokens. If a container is compromised, an adversary ma This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Group Policy Preferences technique in a penetration test.", "input": "Target environment: Windows. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to find unsecured credentials in Group Policy Preferences (GPP). GPP are tools that allow administrators to create domain policies with embedded credentials. These policies allow administrators to set local accounts. These group policies are stored in SYSVOL on a domain controller. This means that any domain user can view the SYSVOL share and decrypt the password (using the AES key that has been made public). The following tools and scripts can be used to gather and decrypt the password file from Group Policy Preference XML files: * Metasploit\u2019s post exploitation module: <code>post/windows/gather/credentials/gpp</code> * Get-GPPPassword * gpprefdecrypt.py On the SYSVOL share, adversaries may use the following command to enumerate potential GPP XML files: <code>dir / This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Network Provider DLL technique in a penetration test.", "input": "Target environment: Windows. Attack phase: credential-access, defense-evasion, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may register malicious network provider dynamic link libraries (DLLs) to capture cleartext user credentials during the authentication process. Network provider DLLs allow Windows to interface with specific network protocols and can also support add-on credential management functions. During the logon process, Winlogon (the interactive logon module) sends credentials to the local process via RPC. The process then shares the credentials in cleartext with registered credential managers when notifying that a logon event is happening. Adversaries can configure a malicious network provider DLL to receive credentials from . Once installed as a credential manager (via the Registry), a malicious DLL can receive and save credentials each time a user logs onto a Windows workstation or dom This technique serves the credential-access, defense-evasion, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Windows Management Instrumentation Event Subscription technique in a penetration test.", "input": "Target environment: Windows. Attack phase: privilege-escalation, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may establish persistence and elevate privileges by executing malicious content triggered by a Windows Management Instrumentation (WMI) event subscription. WMI can be used to install event filters, providers, consumers, and bindings that execute code when a defined event occurs. Examples of events that may be subscribed to are the wall clock time, user login, or the computer's uptime. Adversaries may use the capabilities of WMI to subscribe to an event and execute arbitrary code when that event occurs, providing persistence on a system. Adversaries may also compile WMI scripts \u2013 using \u2013into Windows Management Object (MOF) files (.mof extension) that can be used to create a malicious subscription. WMI subscription execution is proxied by the WMI Provider Host process (WmiPrvSe.e This technique serves the privilege-escalation, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Forge Web Credentials technique in a penetration test.", "input": "Target environment: SaaS, Windows, macOS, Linux, IaaS, Office Suite, Identity Provider. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may forge credential materials that can be used to gain access to web applications or Internet services. Web applications and services (hosted in cloud SaaS environments or on-premise servers) often use session cookies, tokens, or other materials to authenticate and authorize user access. Adversaries may generate these credential materials in order to gain access to web resources. This differs from Steal Web Session Cookie, Steal Application Access Token, and other similar behaviors in that the credentials are new and forged by the adversary, rather than stolen or intercepted from legitimate users. The generation of web credentials often requires secret values, such as passwords, Private Keys, or other cryptographic seed values. Adversaries may also forge tokens by taking advan This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Multi-Factor Authentication Request Generation technique in a penetration test.", "input": "Target environment: Windows, Linux, macOS, IaaS, SaaS, Office Suite, Identity Provider. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to bypass multi-factor authentication (MFA) mechanisms and gain access to accounts by generating MFA requests sent to users. Adversaries in possession of credentials to Valid Accounts may be unable to complete the login process if they lack access to the 2FA or MFA mechanisms required as an additional credential and security control. To circumvent this, adversaries may abuse the automatic generation of push notifications to MFA services such as Duo Push, Microsoft Authenticator, Okta, or similar services to have the user grant access to their account. If adversaries lack credentials to victim accounts, they may also abuse automatic push notification generation when this option is configured for self-service password reset (SSPR). In some cases, adversaries may conti This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Chat Messages technique in a penetration test.", "input": "Target environment: SaaS, Office Suite. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may directly collect unsecured credentials stored or passed through user communication services. Credentials may be sent and stored in user chat communication applications such as email, chat services like Slack or Teams, collaboration tools like Jira or Trello, and any other services that support user communication. Users may share various forms of credentials (such as usernames and passwords, API keys, or authentication tokens) on private or public corporate internal communications channels. Rather than accessing the stored chat logs (i.e., Credentials In Files), adversaries may directly access credentials within these services on the user endpoint, through servers hosting the services, or through administrator portals for cloud hosted services. Adversaries may also compromis This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Change Default File Association technique in a penetration test.", "input": "Target environment: Windows. Attack phase: privilege-escalation, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may establish persistence by executing malicious content triggered by a file type association. When a file is opened, the default program used to open the file (also called the file association or handler) is checked. File association selections are stored in the Windows Registry and can be edited by users, administrators, or programs that have Registry access or by administrators using the built-in assoc utility. Applications can modify the file association for a given file extension to call an arbitrary program when a file with the given extension is opened. System file associations are listed under <code>HKEY_CLASSES_ROOT\\.[extension]</code>, for example <code>HKEY_CLASSES_ROOT\\.txt</code>. The entries point to a handler for that extension located at <code>HKEY_CLASSES_ROOT\\ This technique serves the privilege-escalation, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Exploitation for Credential Access technique in a penetration test.", "input": "Target environment: Linux, Windows, macOS, Identity Provider. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may exploit software vulnerabilities in an attempt to collect credentials. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. Credentialing and authentication mechanisms may be targeted for exploitation by adversaries as a means to gain access to useful credentials or circumvent the process to gain authenticated access to systems. One example of this is , which targets Kerberos and can be used to forge Kerberos tickets using domain user permissions. Another example of this is replay attacks, in which the adversary intercepts data packets sent between parties and then later replays these packets. If services d This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Emond technique in a penetration test.", "input": "Target environment: macOS. Attack phase: privilege-escalation, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may gain persistence and elevate privileges by executing malicious content triggered by the Event Monitor Daemon (emond). Emond is a Launch Daemon that accepts events from various services, runs them through a simple rules engine, and takes action. The emond binary at <code>/sbin/emond</code> will load any rules from the <code>/etc/emond.d/rules/</code> directory and take action once an explicitly defined event takes place. The rule files are in the plist format and define the name, event type, and action to take. Some examples of event types include system startup and user authentication. Examples of actions are to run a system command or send an email. The emond service will not launch if there is no file present in the QueueDirectories path <code>/private/var/db/emondClients This technique serves the privilege-escalation, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Brute Force technique in a penetration test.", "input": "Target environment: Containers, ESXi, IaaS, Identity Provider, Linux, macOS, Network Devices, Office Suite, SaaS, Windows. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained. Without knowledge of the password for an account or set of accounts, an adversary may systematically guess the password using a repetitive or iterative mechanism. Brute forcing passwords can take place via interaction with a service that will check the validity of those credentials or offline against previously acquired credential data, such as password hashes. Brute forcing credentials may take place at various points during a breach. For example, adversaries may attempt to brute force access to Valid Accounts within a victim environment leveraging knowledge gathered from other post-compromise behaviors such as OS Credential Dumping, Account Discovery, or  This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Exploitation for Privilege Escalation technique in a penetration test.", "input": "Target environment: Containers, Linux, macOS, Windows. Attack phase: privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may exploit software vulnerabilities in an attempt to elevate privileges. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. Security constructs such as permission levels will often hinder access to information and use of certain techniques, so adversaries will likely need to perform privilege escalation to include use of software exploitation to circumvent those restrictions. When initially gaining access to a system, an adversary may be operating within a lower privileged process which will prevent them from accessing certain resources on the system. Vulnerabilities may exist, usually in operating system co This technique serves the privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Credential Stuffing technique in a penetration test.", "input": "Target environment: Windows, SaaS, IaaS, Linux, macOS, Containers, Network Devices, Office Suite, Identity Provider, ESXi. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use credentials obtained from breach dumps of unrelated accounts to gain access to target accounts through credential overlap. Occasionally, large numbers of username and password pairs are dumped online when a website or service is compromised and the user account credentials accessed. The information may be useful to an adversary attempting to compromise accounts by taking advantage of the tendency for users to use the same passwords across personal and business accounts. Credential stuffing is a risky option because it could cause numerous authentication failures and account lockouts, depending on the organization's login failure policies. Typically, management services over commonly used ports are used when stuffing credentials. Commonly targeted services include the fo This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Multi-Factor Authentication technique in a penetration test.", "input": "Target environment: Windows, SaaS, IaaS, Linux, macOS, Office Suite, Identity Provider. Attack phase: credential-access, defense-evasion, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may disable or modify multi-factor authentication (MFA) mechanisms to enable persistent access to compromised accounts. Once adversaries have gained access to a network by either compromising an account lacking MFA or by employing an MFA bypass method such as Multi-Factor Authentication Request Generation, adversaries may leverage their access to modify or completely disable MFA defenses. This can be accomplished by abusing legitimate features, such as excluding users from Azure AD Conditional Access Policies, registering a new yet vulnerable/adversary-controlled MFA method, or by manually patching MFA programs and configuration files to bypass expected functionality. For example, modifying the Windows hosts file () to redirect MFA calls to localhost instead of an MFA server ma This technique serves the credential-access, defense-evasion, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Event Triggered Execution technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows, SaaS, IaaS, Office Suite. Attack phase: privilege-escalation, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may establish persistence and/or elevate privileges using system mechanisms that trigger execution based on specific events. Various operating systems have means to monitor and subscribe to events such as logons or other user activity such as running specific applications/binaries. Cloud environments may also support various functions and services that monitor and can be invoked in response to specific cloud events. Adversaries may abuse these mechanisms as a means of maintaining persistent access to a victim via repeatedly executing malicious code. After gaining access to a victim system, adversaries may create/modify event triggers to point to malicious content that will be executed whenever the event trigger is invoked. Since the execution can be proxied by an account with h This technique serves the privilege-escalation, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Unix Shell Configuration Modification technique in a penetration test.", "input": "Target environment: Linux, macOS. Attack phase: privilege-escalation, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may establish persistence through executing malicious commands triggered by a user\u2019s shell. User Unix Shells execute several configuration scripts at different points throughout the session based on events. For example, when a user opens a command-line interface or remotely logs in (such as via SSH) a login shell is initiated. The login shell executes scripts from the system (<code>/etc</code>) and the user\u2019s home directory (<code>~/</code>) to configure the environment. All login shells on a system use /etc/profile when initiated. These configuration scripts run at the permission level of their directory and are often used to set environment variables, create aliases, and customize the user\u2019s environment. When the shell exits or terminates, additional shell scripts are execute This technique serves the privilege-escalation, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Forced Authentication technique in a penetration test.", "input": "Target environment: Windows. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may gather credential material by invoking or forcing a user to automatically provide authentication information through a mechanism in which they can intercept. The Server Message Block (SMB) protocol is commonly used in Windows networks for authentication and communication between systems for access to resources and file sharing. When a Windows system attempts to connect to an SMB resource it will automatically attempt to authenticate and send credential information for the current user to the remote system. This behavior is typical in enterprise environments so that users do not need to enter credentials to access network resources. Web Distributed Authoring and Versioning (WebDAV) is also typically used by Windows systems as a backup protocol when SMB is blocked or fails. W This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Elevated Execution with Prompt technique in a penetration test.", "input": "Target environment: macOS. Attack phase: privilege-escalation, defense-evasion. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may leverage the <code>AuthorizationExecuteWithPrivileges</code> API to escalate privileges by prompting the user for credentials. The purpose of this API is to give application developers an easy way to perform operations with root privileges, such as for application installation or updating. This API does not validate that the program requesting root privileges comes from a reputable source or has been maliciously modified. Although this API is deprecated, it still fully functions in the latest releases of macOS. When calling this API, the user will be prompted to enter their credentials but no checks on the origin or integrity of the program are made. The program calling the API may also load world writable files which can be modified to perform malicious behavior with eleva This technique serves the privilege-escalation, defense-evasion phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Component Object Model Hijacking technique in a penetration test.", "input": "Target environment: Windows. Attack phase: privilege-escalation, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may establish persistence by executing malicious content triggered by hijacked references to Component Object Model (COM) objects. COM is a system within Windows to enable interaction between software components through the operating system. References to various COM objects are stored in the Registry. Adversaries may use the COM system to insert malicious code that can be executed in place of legitimate software through hijacking the COM references and relationships as a means for persistence. Hijacking a COM object requires a change in the Registry to replace a reference to a legitimate system component which may cause that component to not work when executed. When that system component is executed through normal system operation the adversary's code will be executed instead. This technique serves the privilege-escalation, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of ARP Cache Poisoning technique in a penetration test.", "input": "Target environment: Linux, Windows, macOS. Attack phase: credential-access, collection. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may poison Address Resolution Protocol (ARP) caches to position themselves between the communication of two or more networked devices. This activity may be used to enable follow-on behaviors such as Network Sniffing or Transmitted Data Manipulation. The ARP protocol is used to resolve IPv4 addresses to link layer addresses, such as a media access control (MAC) address. Devices in a local network segment communicate with each other by using link layer addresses. If a networked device does not have the link layer address of a particular networked device, it may send out a broadcast ARP request to the local network to translate the IP address to a MAC address. The device with the associated IP address directly replies with its MAC address. The networked device that made the ARP re This technique serves the credential-access, collection phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of AppInit DLLs technique in a penetration test.", "input": "Target environment: Windows. Attack phase: privilege-escalation, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by AppInit DLLs loaded into processes. Dynamic-link libraries (DLLs) that are specified in the <code>AppInit_DLLs</code> value in the Registry keys <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows</code> or <code>HKEY_LOCAL_MACHINE\\Software\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows</code> are loaded by user32.dll into every process that loads user32.dll. In practice this is nearly every program, since user32.dll is a very common library. Similar to Process Injection, these values can be abused to obtain elevated privileges by causing a malicious DLL to be loaded and run in the context of separate processes on the computer. Malicious AppInit DLL This technique serves the privilege-escalation, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Screensaver technique in a penetration test.", "input": "Target environment: Windows. Attack phase: privilege-escalation, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may establish persistence by executing malicious content triggered by user inactivity. Screensavers are programs that execute after a configurable time of user inactivity and consist of Portable Executable (PE) files with a .scr file extension. The Windows screensaver application scrnsave.scr is located in <code>C:\\Windows\\System32\\</code>, and <code>C:\\Windows\\sysWOW64\\</code> on 64-bit Windows systems, along with screensavers included with base Windows installations. The following screensaver settings are stored in the Registry (<code>HKCU\\Control Panel\\Desktop\\</code>) and could be manipulated to achieve persistence: * <code>SCRNSAVE.exe</code> - set to malicious PE path * <code>ScreenSaveActive</code> - set to '1' to enable the screensaver * <code>ScreenSaverIsSecure</code> This technique serves the privilege-escalation, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Conditional Access Policies technique in a penetration test.", "input": "Target environment: IaaS, Identity Provider. Attack phase: credential-access, defense-evasion, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may disable or modify conditional access policies to enable persistent access to compromised accounts. Conditional access policies are additional verifications used by identity providers and identity and access management systems to determine whether a user should be granted access to a resource. For example, in Entra ID, Okta, and JumpCloud, users can be denied access to applications based on their IP address, device enrollment status, and use of multi-factor authentication. In some cases, identity providers may also support the use of risk-based metrics to deny sign-ins based on a variety of indicators. In AWS and GCP, IAM policies can contain attributes that verify arbitrary constraints such as the source IP, the date the request was made, and the nature of the resources or  This technique serves the credential-access, defense-evasion, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Cloud Secrets Management Stores technique in a penetration test.", "input": "Target environment: IaaS. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may acquire credentials from cloud-native secret management solutions such as AWS Secrets Manager, GCP Secret Manager, Azure Key Vault, and Terraform Vault. Secrets managers support the secure centralized management of passwords, API keys, and other credential material. Where secrets managers are in use, cloud services can dynamically acquire credentials via API requests rather than accessing secrets insecurely stored in plain text files or environment variables. If an adversary is able to gain sufficient privileges in a cloud environment \u2013 for example, by obtaining the credentials of high-privileged Cloud Accounts or compromising a service that has permission to retrieve secrets \u2013 they may be able to request secrets from the secrets manager. This can be accomplished via comman This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of /etc/passwd and /etc/shadow technique in a penetration test.", "input": "Target environment: Linux. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to dump the contents of <code>/etc/passwd</code> and <code>/etc/shadow</code> to enable offline password cracking. Most modern Linux operating systems use a combination of <code>/etc/passwd</code> and <code>/etc/shadow</code> to store user account information, including password hashes in <code>/etc/shadow</code>. By default, <code>/etc/shadow</code> is only readable by the root user. Linux stores user information such as user ID, group ID, home directory path, and login shell in <code>/etc/passwd</code>. A \"user\" on the system may belong to a person or a service. All password hashes are stored in <code>/etc/shadow</code> - including entries for users with no passwords and users with locked or disabled accounts. Adversaries may attempt to read or dump the <code>/etc This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Silver Ticket technique in a penetration test.", "input": "Target environment: Windows. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries who have the password hash of a target service account (e.g. SharePoint, MSSQL) may forge Kerberos ticket granting service (TGS) tickets, also known as silver tickets. Kerberos TGS tickets are also known as service tickets. Silver tickets are more limited in scope in than golden tickets in that they only enable adversaries to access a particular resource (e.g. MSSQL) and the system that hosts the resource; however, unlike golden tickets, adversaries with the ability to forge silver tickets are able to create TGS tickets without interacting with the Key Distribution Center (KDC), potentially making detection more difficult. Password hashes for target services may be obtained using OS Credential Dumping or Kerberoasting. This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Windows Credential Manager technique in a penetration test.", "input": "Target environment: Windows. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may acquire credentials from the Windows Credential Manager. The Credential Manager stores credentials for signing into websites, applications, and/or devices that request authentication through NTLM or Kerberos in Credential Lockers (previously known as Windows Vaults). The Windows Credential Manager separates website credentials from application or network credentials in two lockers. As part of Credentials from Web Browsers, Internet Explorer and Microsoft Edge website credentials are managed by the Credential Manager and are stored in the Web Credentials locker. Application and network credentials are stored in the Windows Credentials locker. Credential Lockers store credentials in encrypted files, located under . The encryption key can be found in a file named <code>Policy. This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Domain Controller Authentication technique in a penetration test.", "input": "Target environment: Windows. Attack phase: credential-access, defense-evasion, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may patch the authentication process on a domain controller to bypass the typical authentication mechanisms and enable access to accounts. Malware may be used to inject false credentials into the authentication process on a domain controller with the intent of creating a backdoor used to access any user\u2019s account and/or credentials (ex: Skeleton Key). Skeleton key works through a patch on an enterprise domain controller authentication process (LSASS) with credentials that adversaries may use to bypass the standard authentication system. Once patched, an adversary can use the injected password to successfully authenticate as any domain user account (until the the skeleton key is erased from memory by a reboot of the domain controller). Authenticated access may enable unfettered  This technique serves the credential-access, defense-evasion, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Reversible Encryption technique in a penetration test.", "input": "Target environment: Windows. Attack phase: credential-access, defense-evasion, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: An adversary may abuse Active Directory authentication encryption properties to gain access to credentials on Windows systems. The <code>AllowReversiblePasswordEncryption</code> property specifies whether reversible password encryption for an account is enabled or disabled. By default this property is disabled (instead storing user credentials as the output of one-way hashing functions) and should not be enabled unless legacy or other software require it. If the property is enabled and/or a user changes their password after it is enabled, an adversary may be able to obtain the plaintext of passwords created/changed after the property was enabled. To decrypt the passwords, an adversary needs four components: 1. Encrypted password (<code>G$RADIUSCHAP</code>) from the Active Directory user-st This technique serves the credential-access, defense-evasion, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Installer Packages technique in a penetration test.", "input": "Target environment: Linux, Windows, macOS. Attack phase: privilege-escalation, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may establish persistence and elevate privileges by using an installer to trigger the execution of malicious content. Installer packages are OS specific and contain the resources an operating system needs to install applications on a system. Installer packages can include scripts that run prior to installation as well as after installation is complete. Installer scripts may inherit elevated permissions when executed. Developers often use these scripts to prepare the environment for installation, check requirements, download dependencies, and remove files after installation. Using legitimate applications, adversaries have distributed applications with modified installer scripts to execute malicious content. When a user installs the application, they may be required to grant admi This technique serves the privilege-escalation, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Multi-Factor Authentication Interception technique in a penetration test.", "input": "Target environment: Linux, Windows, macOS. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may target multi-factor authentication (MFA) mechanisms, (i.e., smart cards, token generators, etc.) to gain access to credentials that can be used to access systems, services, and network resources. Use of MFA is recommended and provides a higher level of security than usernames and passwords alone, but organizations should be aware of techniques that could be used to intercept and bypass these security mechanisms. If a smart card is used for multi-factor authentication, then a keylogger will need to be used to obtain the password associated with a smart card during normal use. With both an inserted card and access to the smart card password, an adversary can connect to a network resource using the infected system to proxy the authentication with the inserted hardware token. A This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of NTDS technique in a penetration test.", "input": "Target environment: Windows. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to access or create a copy of the Active Directory domain database in order to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights. By default, the NTDS file (NTDS.dit) is located in <code>%SystemRoot%\\NTDS\\Ntds.dit</code> of a domain controller. In addition to looking for NTDS files on active Domain Controllers, adversaries may search for backups that contain the same or similar information. The following tools and techniques can be used to enumerate the NTDS file and the contents of the entire Active Directory hashes. * Volume Shadow Copy * secretsdump.py * Using the in-built Windows tool, ntdsutil.exe * Invoke-NinjaCopy This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Kerberoasting technique in a penetration test.", "input": "Target environment: Windows. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse a valid Kerberos ticket-granting ticket (TGT) or sniff network traffic to obtain a ticket-granting service (TGS) ticket that may be vulnerable to Brute Force. Service principal names (SPNs) are used to uniquely identify each instance of a Windows service. To enable authentication, Kerberos requires that SPNs be associated with at least one service logon account (an account specifically tasked with running a service). Adversaries possessing a valid Kerberos ticket-granting ticket (TGT) may request one or more Kerberos ticket-granting service (TGS) service tickets for any SPN from a domain controller (DC). Portions of these tickets may be encrypted with the RC4 algorithm, meaning the Kerberos 5 TGS-REP etype 23 hash of the service account associated with the SPN is used This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of DCSync technique in a penetration test.", "input": "Target environment: Windows. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to access credentials and other sensitive information by abusing a Windows Domain Controller's application programming interface (API) to simulate the replication process from a remote domain controller using a technique called DCSync. Members of the Administrators, Domain Admins, and Enterprise Admin groups or computer accounts on the domain controller are able to run DCSync to pull password data from Active Directory, which may include current and historical hashes of potentially useful accounts such as KRBTGT and Administrators. The hashes can then in turn be used to create a Golden Ticket for use in Pass the Ticket or change an account's password as noted in Account Manipulation. DCSync functionality has been included in the \"lsadump\" module in Mimikatz. Lsadump This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Modify Authentication Process technique in a penetration test.", "input": "Target environment: Windows, Linux, macOS, Network Devices, IaaS, SaaS, Office Suite, Identity Provider. Attack phase: credential-access, defense-evasion, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may modify authentication mechanisms and processes to access user credentials or enable otherwise unwarranted access to accounts. The authentication process is handled by mechanisms, such as the Local Security Authentication Server (LSASS) process and the Security Accounts Manager (SAM) on Windows, pluggable authentication modules (PAM) on Unix-based systems, and authorization plugins on MacOS systems, responsible for gathering, storing, and validating credentials. By modifying an authentication process, an adversary may be able to authenticate to a service or system without using Valid Accounts. Adversaries may maliciously modify a part of this process to either reveal credentials or bypass authentication mechanisms. Compromised credentials or access may be used to bypass acce This technique serves the credential-access, defense-evasion, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Netsh Helper DLL technique in a penetration test.", "input": "Target environment: Windows. Attack phase: privilege-escalation, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may establish persistence by executing malicious content triggered by Netsh Helper DLLs. Netsh.exe (also referred to as Netshell) is a command-line scripting utility used to interact with the network configuration of a system. It contains functionality to add helper DLLs for extending functionality of the utility. The paths to registered netsh.exe helper DLLs are entered into the Windows Registry at <code>HKLM\\SOFTWARE\\Microsoft\\Netsh</code>. Adversaries can use netsh.exe helper DLLs to trigger execution of arbitrary code in a persistent manner. This execution would take place anytime netsh.exe is executed, which could happen automatically, with another persistence technique, or if other software (ex: VPN) is present on the system that executes netsh.exe as part of its normal f This technique serves the privilege-escalation, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Container API technique in a penetration test.", "input": "Target environment: Containers. Attack phase: credential-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may gather credentials via APIs within a containers environment. APIs in these environments, such as the Docker API and Kubernetes APIs, allow a user to remotely manage their container resources and cluster components. An adversary may access the Docker API to collect logs that contain credentials to cloud, container, and various other resources in the environment. An adversary with sufficient permissions, such as via a pod's service account, may also use the Kubernetes API to retrieve credentials from the Kubernetes API server. These credentials may include those needed for Docker API authentication or secrets from Kubernetes cluster components. This technique serves the credential-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Network Device Authentication technique in a penetration test.", "input": "Target environment: Network Devices. Attack phase: credential-access, defense-evasion, persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use Patch System Image to hard code a password in the operating system, thus bypassing of native authentication mechanisms for local accounts on network devices. Modify System Image may include implanted code to the operating system for network devices to provide access for adversaries using a specific password. The modification includes a specific password which is implanted in the operating system image via the patch. Upon authentication attempts, the inserted code will first check to see if the user input is the password. If so, access is granted. Otherwise, the implanted code will pass the credentials on for verification of potentially valid credentials. This technique serves the credential-access, defense-evasion, persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
