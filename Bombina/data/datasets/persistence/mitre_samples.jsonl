{"instruction": "Analyze the use of Boot or Logon Initialization Scripts technique in a penetration test.", "input": "Target environment: macOS, Windows, Linux, Network Devices, ESXi. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use scripts automatically executed at boot or logon initialization to establish persistence. Initialization scripts can be used to perform administrative functions, which may often execute other programs or send information to an internal logging server. These scripts can vary based on operating system and whether applied locally or remotely. Adversaries may use these scripts to maintain persistence on a single system. Depending on the access configuration of the logon scripts, either local credentials or an administrator account may be necessary. An adversary may also be able to escalate their privileges since some boot or logon initialization scripts run with higher privileges. This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Path Interception by PATH Environment Variable technique in a penetration test.", "input": "Target environment: Windows, macOS, Linux. Attack phase: persistence, privilege-escalation, defense-evasion. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may execute their own malicious payloads by hijacking environment variables used to load libraries. The PATH environment variable contains a list of directories (User and System) that the OS searches sequentially through in search of the binary that was called from a script or the command line. Adversaries can place a malicious program in an earlier entry in the list of directories stored in the PATH environment variable, resulting in the operating system executing the malicious binary rather than the legitimate binary when it searches sequentially through that PATH listing. For example, on Windows if an adversary places a malicious program named \"net.exe\" in , which by default precedes in the PATH environment variable, when \"net\" is executed from the command-line the will be c This technique serves the persistence, privilege-escalation, defense-evasion phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Create or Modify System Process technique in a penetration test.", "input": "Target environment: Windows, macOS, Linux, Containers. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may create or modify system-level processes to repeatedly execute malicious payloads as part of persistence. When operating systems boot up, they can start processes that perform background system functions. On Windows and Linux, these system processes are referred to as services. On macOS, launchd processes known as Launch Daemon and Launch Agent are run to finish system initialization and load user specific parameters. Adversaries may install new services, daemons, or agents that can be configured to execute at startup or a repeatable interval in order to establish persistence. Similarly, adversaries may modify existing services, daemons, or agents to achieve the same effect. Services, daemons, or agents may be created with administrator privileges but executed under root/SYS This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of External Remote Services technique in a penetration test.", "input": "Target environment: Containers, Linux, macOS, Windows. Attack phase: persistence, initial-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may leverage external-facing remote services to initially access and/or persist within a network. Remote services such as VPNs, Citrix, and other access mechanisms allow users to connect to internal enterprise network resources from external locations. There are often remote service gateways that manage connections and credential authentication for these services. Services such as Windows Remote Management and VNC can also be used externally. Access to Valid Accounts to use the service is often a requirement, which could be obtained through credential pharming or by obtaining the credentials from users after compromising the enterprise network. Access to remote services may be used as a redundant or persistent access mechanism during an operation. Access may also be gained thro This technique serves the persistence, initial-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of System Firmware technique in a penetration test.", "input": "Target environment: Windows, Network Devices. Attack phase: persistence, defense-evasion. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may modify system firmware to persist on systems.The BIOS (Basic Input/Output System) and The Unified Extensible Firmware Interface (UEFI) or Extensible Firmware Interface (EFI) are examples of system firmware that operate as the software interface between the operating system and hardware of a computer. System firmware like BIOS and (U)EFI underly the functionality of a computer and may be modified by an adversary to perform or assist in malicious activity. Capabilities exist to overwrite the system firmware, which may give sophisticated adversaries a means to install malicious firmware updates as a means of persistence on a system that may be difficult to detect. This technique serves the persistence, defense-evasion phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Services Registry Permissions Weakness technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence, privilege-escalation, defense-evasion. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may execute their own malicious payloads by hijacking the Registry entries used by services. Flaws in the permissions for Registry keys related to services can allow adversaries to redirect the originally specified executable to one they control, launching their own code when a service starts. Windows stores local service configuration information in the Registry under <code>HKLM\\SYSTEM\\CurrentControlSet\\Services</code>. The information stored under a service's Registry keys can be manipulated to modify a service's execution parameters through tools such as the service controller, sc.exe, PowerShell, or Reg. Access to Registry keys is controlled through access control lists and user permissions. If the permissions for users and groups are not properly set and allow access to th This technique serves the persistence, privilege-escalation, defense-evasion phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Bootkit technique in a penetration test.", "input": "Target environment: Linux, Windows. Attack phase: persistence, defense-evasion. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use bootkits to persist on systems. A bootkit is a malware variant that modifies the boot sectors of a hard drive, allowing malicious code to execute before a computer's operating system has loaded. Bootkits reside at a layer below the operating system and may make it difficult to perform full remediation unless an organization suspects one was used and can act accordingly. In BIOS systems, a bootkit may modify the Master Boot Record (MBR) and/or Volume Boot Record (VBR). The MBR is the section of disk that is first loaded after completing hardware initialization by the BIOS. It is the location of the boot loader. An adversary who has raw access to the boot drive may overwrite this area, diverting execution during startup from the normal boot loader to adversary code. The M This technique serves the persistence, defense-evasion phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Boot or Logon Autostart Execution technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows, Network Devices. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may configure system settings to automatically execute a program during system boot or logon to maintain persistence or gain higher-level privileges on compromised systems. Operating systems may have mechanisms for automatically running a program on system boot or account logon. These mechanisms may include automatically executing programs that are placed in specially designated directories or are referenced by repositories that store configuration information, such as the Windows Registry. An adversary may achieve the same goal by modifying or extending features of the kernel. Since some boot or logon autostart programs run with higher privileges, an adversary may leverage these to elevate privileges. This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Active Setup technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may achieve persistence by adding a Registry key to the Active Setup of the local machine. Active Setup is a Windows mechanism that is used to execute programs when a user logs in. The value stored in the Registry key will be executed after a user logs into the computer. These programs will be executed under the context of the user and will have the account's associated permissions level. Adversaries may abuse Active Setup by creating a key under <code> HKLM\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\</code> and setting a malicious value for <code>StubPath</code>. This value will serve as the program that will be executed when a user logs into the computer. Adversaries can abuse these components to execute malware, such as remote access tools, to maintain persistence  This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Browser Extensions technique in a penetration test.", "input": "Target environment: Linux, Windows, macOS. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse internet browser extensions to establish persistent access to victim systems. Browser extensions or plugins are small programs that can add functionality to and customize aspects of internet browsers. They can be installed directly via a local file or custom URL or through a browser's app store - an official online platform where users can browse, install, and manage extensions for a specific web browser. Extensions generally inherit the web browser's permissions previously granted. Malicious extensions can be installed into a browser through malicious app store downloads masquerading as legitimate extensions, through social engineering, or by an adversary that has already compromised a system. Security can be limited on browser app stores, so it may not be difficult  This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Windows Service technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may create or modify Windows services to repeatedly execute malicious payloads as part of persistence. When Windows boots up, it starts programs or applications called services that perform background system functions. Windows service configuration information, including the file path to the service's executable or recovery programs/commands, is stored in the Windows Registry. Adversaries may install a new service or modify an existing service to execute at startup in order to persist on a system. Service configurations can be set or modified using system utilities (such as sc.exe), by directly modifying the Registry, or by interacting directly with the Windows API. Adversaries may also use services to install and execute malicious drivers. For example, after dropping a driver  This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Office Application Startup technique in a penetration test.", "input": "Target environment: Windows, Office Suite. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may leverage Microsoft Office-based applications for persistence between startups. Microsoft Office is a fairly common application suite on Windows-based operating systems within an enterprise network. There are multiple mechanisms that can be used with Office for persistence when an Office-based application is started; this can include the use of Office Template Macros and add-ins. A variety of features have been discovered in Outlook that can be abused to obtain persistence, such as Outlook rules, forms, and Home Page. These persistence mechanisms can work within Outlook or be used through Office 365. This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Additional Cloud Roles technique in a penetration test.", "input": "Target environment: IaaS, Identity Provider, Office Suite, SaaS. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: An adversary may add additional roles or permissions to an adversary-controlled cloud account to maintain persistent access to a tenant. For example, adversaries may update IAM policies in cloud-based environments or add a new global administrator in Office 365 environments. With sufficient permissions, a compromised account can gain almost unlimited access to data and settings (including the ability to reset the passwords of other admins). This account modification may immediately follow Create Account or other malicious account activity. Adversaries may also modify existing Valid Accounts that they have compromised. This could lead to privilege escalation, particularly if the roles added allow for lateral movement to additional accounts. For example, in AWS environments, an adversary wit This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Print Processors technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse print processors to run malicious DLLs during system boot for persistence and/or privilege escalation. Print processors are DLLs that are loaded by the print spooler service, , during boot. Adversaries may abuse the print spooler service by adding print processors that load malicious DLLs at startup. A print processor can be installed through the <code>AddPrintProcessor</code> API call with an account that has <code>SeLoadDriverPrivilege</code> enabled. Alternatively, a print processor can be registered to the print spooler service by adding the <code>HKLM\\SYSTEM\\\\[CurrentControlSet or ControlSet001]\\Control\\Print\\Environments\\\\[Windows architecture: e.g., Windows x64]\\Print Processors\\\\[user defined]\\Driver</code> Registry key that points to the DLL. For the maliciou This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of DLL technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence, privilege-escalation, defense-evasion. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse dynamic-link library files (DLLs) in order to achieve persistence, escalate privileges, and evade defenses. DLLs are libraries that contain code and data that can be simultaneously utilized by multiple programs. While DLLs are not malicious by nature, they can be abused through mechanisms such as side-loading, hijacking search order, and phantom DLL hijacking. Specific ways DLLs are abused by adversaries include: ### DLL Sideloading Adversaries may execute their own malicious payloads by side-loading DLLs. Side-loading involves hijacking which DLL a program loads by planting and then invoking a legitimate application that executes their payload(s). Side-loading positions both the victim application and malicious payload(s) alongside each other. Adversaries likely use  This technique serves the persistence, privilege-escalation, defense-evasion phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Add-ins technique in a penetration test.", "input": "Target environment: Windows, Office Suite. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse Microsoft Office add-ins to obtain persistence on a compromised system. Office add-ins can be used to add functionality to Office programs. There are different types of add-ins that can be used by the various Office products; including Word/Excel add-in Libraries (WLL/XLL), VBA add-ins, Office Component Object Model (COM) add-ins, automation add-ins, VBA Editor (VBE), Visual Studio Tools for Office (VSTO) add-ins, and Outlook add-ins. Add-ins can be used to obtain persistence because they can be set to execute code when an Office application starts. This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Transport Agent technique in a penetration test.", "input": "Target environment: Linux, Windows. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse Microsoft transport agents to establish persistent access to systems. Microsoft Exchange transport agents can operate on email messages passing through the transport pipeline to perform various tasks such as filtering spam, filtering malicious attachments, journaling, or adding a corporate signature to the end of all outgoing emails. Transport agents can be written by application developers and then compiled to .NET assemblies that are subsequently registered with the Exchange server. Transport agents will be invoked during a specified stage of email processing and carry out developer defined tasks. Adversaries may register a malicious transport agent to provide a persistence mechanism in Exchange Server that can be triggered by adversary-specified email events. Thoug This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of AppDomainManager technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence, privilege-escalation, defense-evasion. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may execute their own malicious payloads by hijacking how the .NET loads assemblies. The .NET framework uses the class to create and manage one or more isolated runtime environments (called application domains) inside a process to host the execution of .NET applications. Assemblies ( or binaries compiled to run as .NET code) may be loaded into an application domain as executable code. Known as \"AppDomainManager injection,\" adversaries may execute arbitrary code by hijacking how .NET applications load assemblies. For example, malware may create a custom application domain inside a target process to load and execute an arbitrary assembly. Alternatively, configuration files () or process environment variables that define .NET runtime settings may be tampered with to instruct other This technique serves the persistence, privilege-escalation, defense-evasion phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Additional Container Cluster Roles technique in a penetration test.", "input": "Target environment: Containers. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: An adversary may add additional roles or permissions to an adversary-controlled user or service account to maintain persistent access to a container orchestration system. For example, an adversary with sufficient permissions may create a RoleBinding or a ClusterRoleBinding to bind a Role or ClusterRole to a Kubernetes account. Where attribute-based access control (ABAC) is in use, an adversary with sufficient permissions may modify a Kubernetes ABAC policy to give the target account additional permissions. This account modification may immediately follow Create Account or other malicious account activity. Adversaries may also modify existing Valid Accounts that they have compromised. Note that where container orchestration systems are deployed in cloud environments, as with Google Kubernet This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Terminal Services DLL technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse components of Terminal Services to enable persistent access to systems. Microsoft Terminal Services, renamed to Remote Desktop Services in some Windows Server OSs as of 2022, enable remote terminal connections to hosts. Terminal Services allows servers to transmit a full, interactive, graphical user interface to clients via RDP. Windows Services that are run as a \"generic\" process (ex: <code>svchost.exe</code>) load the service's DLL file, the location of which is stored in a Registry entry named <code>ServiceDll</code>. The <code>termsrv.dll</code> file, typically stored in , is the default <code>ServiceDll</code> value for Terminal Services in . Adversaries may modify and/or replace the Terminal Services DLL to enable persistent access to victimized hosts. Modificat This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Software Extensions technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse software extensions to establish persistent access to victim systems. Software extensions are modular components that enhance or customize the functionality of software applications, including web browsers, Integrated Development Environments (IDEs), and other platforms. Extensions are typically installed via official marketplaces, app stores, or manually loaded by users, and they often inherit the permissions and access levels of the host application. Malicious extensions can be introduced through various methods, including social engineering, compromised marketplaces, or direct installation by users or by adversaries who have already gained access to a system. Malicious extensions can be named similarly or identically to benign extensions in marketplaces. Security m This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Outlook Rules technique in a penetration test.", "input": "Target environment: Windows, Office Suite. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse Microsoft Outlook rules to obtain persistence on a compromised system. Outlook rules allow a user to define automated behavior to manage email messages. A benign rule might, for example, automatically move an email to a particular folder in Outlook if it contains specific words from a specific sender. Malicious Outlook rules can be created that can trigger code execution when an adversary sends a specifically crafted email to that user. Once malicious rules have been added to the user\u2019s mailbox, they will be loaded when Outlook is started. Malicious rules will execute when an adversary sends a specifically crafted email to the user. This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Additional Local or Domain Groups technique in a penetration test.", "input": "Target environment: Windows, macOS, Linux. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: An adversary may add additional local or domain groups to an adversary-controlled account to maintain persistent access to a system or domain. On Windows, accounts may use the and commands to add existing users to local and domain groups. On Linux, adversaries may use the command for the same purpose. For example, accounts may be added to the local administrators group on Windows devices to maintain elevated privileges. They may also be added to the Remote Desktop Users group, which allows them to leverage Remote Desktop Protocol to log into the endpoints in the future. Adversaries may also add accounts to VPN user groups to gain future persistence on the network. On Linux, accounts may be added to the sudoers group, allowing them to persistently leverage Sudo and Sudo Caching for elevated This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Port Monitors technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use port monitors to run an adversary supplied DLL during system boot for persistence or privilege escalation. A port monitor can be set through the <code>AddMonitor</code> API call to set a DLL to be loaded at startup. This DLL can be located in <code>C:\\Windows\\System32</code> and will be loaded and run by the print spooler service, , under SYSTEM level permissions on boot. Alternatively, an arbitrary DLL can be loaded if permissions allow writing a fully-qualified pathname for that DLL to the value of an existing or new arbitrarily named subkey of <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Print\\Monitors</code>. The Registry key contains entries for the following: * Local Port * Standard TCP/IP Port * USB Monitor * WSD Port This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Login Hook technique in a penetration test.", "input": "Target environment: macOS. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use a Login Hook to establish persistence executed upon user logon. A login hook is a plist file that points to a specific script to execute with root privileges upon user logon. The plist file is located in the <code>/Library/Preferences/com.apple.loginwindow.plist</code> file and can be modified using the <code>defaults</code> command-line utility. This behavior is the same for logout hooks where a script can be executed upon user logout. All hooks require administrator permissions to modify or create hooks. Adversaries can add or insert a path to a malicious script in the <code>com.apple.loginwindow.plist</code> file, using the <code>LoginHook</code> or <code>LogoutHook</code> key-value pair. The malicious script is executed upon the next user login. If a login hook alre This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Shortcut Modification technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may create or modify shortcuts that can execute a program during system boot or user login. Shortcuts or symbolic links are used to reference other files or programs that will be opened or executed when the shortcut is clicked or executed by a system startup process. Adversaries may abuse shortcuts in the startup folder to execute their tools and achieve persistence. Although often used as payloads in an infection chain (e.g. Spearphishing Attachment), adversaries may also create a new shortcut as a means of indirection, while also abusing Masquerading to make the malicious shortcut appear as a legitimate program. Adversaries can also edit the target path or entirely replace an existing shortcut so their malware will be executed instead of the intended legitimate program. Short This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Implant Internal Image technique in a penetration test.", "input": "Target environment: IaaS, Containers. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may implant cloud or container images with malicious code to establish persistence after gaining access to an environment. Amazon Web Services (AWS) Amazon Machine Images (AMIs), Google Cloud Platform (GCP) Images, and Azure Images as well as popular container runtimes such as Docker can be implanted or backdoored. Unlike Upload Malware, this technique focuses on adversaries implanting an image in a registry within a victim\u2019s environment. Depending on how the infrastructure is provisioned, this could provide persistent access if the infrastructure provisioning tool is instructed to always use the latest image. A tool has been developed to facilitate planting backdoors in cloud container images. If an adversary has access to a compromised AWS instance, and permissions to list th This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Security Support Provider technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse security support providers (SSPs) to execute DLLs when the system boots. Windows SSP DLLs are loaded into the Local Security Authority (LSA) process at system start. Once loaded into the LSA, SSP DLLs have access to encrypted and plaintext passwords that are stored in Windows, such as any logged-on user's Domain password or smart card PINs. The SSP configuration is stored in two Registry keys: <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Security Packages</code> and <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\OSConfig\\Security Packages</code>. An adversary may modify these Registry keys to add new SSPs, which will be loaded the next time the system boots, or when the AddSecurityPackage Windows API function is called. This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Launch Daemon technique in a penetration test.", "input": "Target environment: macOS. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may create or modify Launch Daemons to execute malicious payloads as part of persistence. Launch Daemons are plist files used to interact with Launchd, the service management framework used by macOS. Launch Daemons require elevated privileges to install, are executed for every user on a system prior to login, and run in the background without the need for user interaction. During the macOS initialization startup, the launchd process loads the parameters for launch-on-demand system-level daemons from plist files found in <code>/System/Library/LaunchDaemons/</code> and <code>/Library/LaunchDaemons/</code>. Required Launch Daemons parameters include a <code>Label</code> to identify the task, <code>Program</code> to provide a path to the executable, and <code>RunAtLoad</code> to sp This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Path Interception by Search Order Hijacking technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence, privilege-escalation, defense-evasion. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may execute their own malicious payloads by hijacking the search order used to load other programs. Because some programs do not call other programs using the full path, adversaries may place their own file in the directory where the calling program is located, causing the operating system to launch their malicious software at the request of the calling program. Search order hijacking occurs when an adversary abuses the order in which Windows searches for programs that are not given a path. Unlike DLL search order hijacking, the search order differs depending on the method that is used to execute the program. However, it is common for Windows to search in the directory of the initiating program before searching through the Windows system directory. An adversary who finds a prog This technique serves the persistence, privilege-escalation, defense-evasion phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Web Shell technique in a penetration test.", "input": "Target environment: Linux, macOS, Network Devices, Windows. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may backdoor web servers with web shells to establish persistent access to systems. A Web shell is a Web script that is placed on an openly accessible Web server to allow an adversary to access the Web server as a gateway into a network. A Web shell may provide a set of functions to execute or a command-line interface on the system that hosts the Web server. In addition to a server-side script, a Web shell may have a client interface program that is used to talk to the Web server (e.g. China Chopper Web shell client). This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Time Providers technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse time providers to execute DLLs when the system boots. The Windows Time service (W32Time) enables time synchronization across and within domains. W32Time time providers are responsible for retrieving time stamps from hardware/network resources and outputting these values to other network clients. Time providers are implemented as dynamic-link libraries (DLLs) that are registered in the subkeys of . The time provider manager, directed by the service control manager, loads and starts time providers listed and enabled under this key at system startup and/or whenever parameters are changed. Adversaries may abuse this architecture to establish persistence, specifically by creating a new arbitrarily named subkey pointing to a malicious DLL in the value. Administrator privile This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Dynamic Linker Hijacking technique in a penetration test.", "input": "Target environment: Linux, macOS. Attack phase: persistence, privilege-escalation, defense-evasion. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may execute their own malicious payloads by hijacking environment variables the dynamic linker uses to load shared libraries. During the execution preparation phase of a program, the dynamic linker loads specified absolute paths of shared libraries from various environment variables and files, such as <code>LD_PRELOAD</code> on Linux or <code>DYLD_INSERT_LIBRARIES</code> on macOS. Libraries specified in environment variables are loaded first, taking precedence over system libraries with the same function name. Each platform's linker uses an extensive list of environment variables at different points in execution. These variables are often used by developers to debug binaries without needing to recompile, deconflict mapped symbols, and implement custom functions in the original  This technique serves the persistence, privilege-escalation, defense-evasion phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Local Account technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows, Network Devices, Containers, ESXi. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may create a local account to maintain access to victim systems. Local accounts are those configured by an organization for use by users, remote support, services, or for administration on a single system or service. For example, with a sufficient level of access, the Windows <code>net user /add</code> command can be used to create a local account. In Linux, the command can be used, while on macOS systems, the <code>dscl -create</code> command can be used. Local accounts may also be added to network devices, often via common Network Device CLI commands such as <code>username</code>, to ESXi servers via , or to Kubernetes clusters using the utility. Adversaries may also create new local accounts on network firewall management consoles \u2013 for example, by exploiting a vulnerable fi This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of IDE Extensions technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse an integrated development environment (IDE) extension to establish persistent access to victim systems. IDEs such as Visual Studio Code, IntelliJ IDEA, and Eclipse support extensions - software components that add features like code linting, auto-completion, task automation, or integration with tools like Git and Docker. A malicious extension can be installed through an extension marketplace (i.e., Compromise Software Dependencies and Development Tools) or side-loaded directly into the IDE. In addition to installing malicious extensions, adversaries may also leverage benign ones. For example, adversaries may establish persistent SSH tunnels via the use of the VSCode Remote SSH extension (i.e., IDE Tunneling). Trust is typically established through the installation pro This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Winlogon Helper DLL technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse features of Winlogon to execute DLLs and/or executables when a user logs in. Winlogon.exe is a Windows component responsible for actions at logon/logoff as well as the secure attention sequence (SAS) triggered by Ctrl-Alt-Delete. Registry entries in <code>HKLM\\Software[\\\\Wow6432Node\\\\]\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\</code> and <code>HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\</code> are used to manage additional helper programs and functionalities that support Winlogon. Malicious modifications to these Registry keys may cause Winlogon to load and execute malicious DLLs and/or executables. Specifically, the following subkeys have been known to be possibly vulnerable to abuse: * Winlogon\\Notify - points to notification package DLLs that ha This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of SSH Authorized Keys technique in a penetration test.", "input": "Target environment: Linux, macOS, IaaS, Network Devices, ESXi. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may modify the SSH <code>authorized_keys</code> file to maintain persistence on a victim host. Linux distributions, macOS, and ESXi hypervisors commonly use key-based authentication to secure the authentication process of SSH sessions for remote management. The <code>authorized_keys</code> file in SSH specifies the SSH keys that can be used for logging into the user account for which the file is configured. This file is usually found in the user's home directory under <code>&lt;user-home&gt;/.ssh/authorized_keys</code> (or, on ESXi, ). Users may edit the system\u2019s SSH config file to modify the directives and to the value to ensure public key and RSA authentication are enabled, as well as modify the directive to the value to enable root authentication via SSH. The SSH config file This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Executable Installer File Permissions Weakness technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence, privilege-escalation, defense-evasion. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may execute their own malicious payloads by hijacking the binaries used by an installer. These processes may automatically execute specific binaries as part of their functionality or to perform other actions. If the permissions on the file system directory containing a target binary, or permissions on the binary itself, are improperly set, then the target binary may be overwritten with another binary using user-level permissions and executed by the original process. If the original process and thread are running under a higher permissions level, then the replaced binary will also execute under higher-level permissions, which could include SYSTEM. Another variation of this technique can be performed by taking advantage of a weakness that is common in executable, self-extracting  This technique serves the persistence, privilege-escalation, defense-evasion phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Domain Account technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may create a domain account to maintain access to victim systems. Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain. Domain accounts can cover user, administrator, and service accounts. With a sufficient level of access, the <code>net user /add /domain</code> command can be used to create a domain account. Such accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system. This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Component Firmware technique in a penetration test.", "input": "Target environment: Windows, Linux, macOS. Attack phase: persistence, defense-evasion. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may modify component firmware to persist on systems. Some adversaries may employ sophisticated means to compromise computer components and install malicious firmware that will execute adversary code outside of the operating system and main system firmware or BIOS. This technique may be similar to System Firmware but conducted upon other system components/devices that may not have the same capability or level of integrity checking. Malicious component firmware could provide both a persistent level of access to systems despite potential typical failures to maintain access and hard disk re-images, as well as a way to evade host software-based defenses and integrity checks. This technique serves the persistence, defense-evasion phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Office Template Macros technique in a penetration test.", "input": "Target environment: Windows, Office Suite. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse Microsoft Office templates to obtain persistence on a compromised system. Microsoft Office contains templates that are part of common Office applications and are used to customize styles. The base templates within the application are used each time an application starts. Office Visual Basic for Applications (VBA) macros can be inserted into the base template and used to execute code when the respective Office application starts in order to obtain persistence. Examples for both Word and Excel have been discovered and published. By default, Word has a Normal.dotm template created that can be modified to include a malicious macro. Excel does not have a template file created by default, but one can be added that will automatically be loaded. Shared templates may also be s This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Device Registration technique in a penetration test.", "input": "Target environment: Windows, Identity Provider. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may register a device to an adversary-controlled account. Devices may be registered in a multifactor authentication (MFA) system, which handles authentication to the network, or in a device management system, which handles device access and compliance. MFA systems, such as Duo or Okta, allow users to associate devices with their accounts in order to complete MFA requirements. An adversary that compromises a user\u2019s credentials may enroll a new device in order to bypass initial MFA requirements and gain persistent access to a network. In some cases, the MFA self-enrollment process may require only a username and password to enroll the account's first device or to enroll a device to an inactive account. Similarly, an adversary with existing access to a network may register a devic This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Login Items technique in a penetration test.", "input": "Target environment: macOS. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may add login items to execute upon user login to gain persistence or escalate privileges. Login items are applications, documents, folders, or server connections that are automatically launched when a user logs in. Login items can be added via a shared file list or Service Management Framework. Shared file list login items can be set using scripting languages such as AppleScript, whereas the Service Management Framework uses the API call <code>SMLoginItemSetEnabled</code>. Login items installed using the Service Management Framework leverage <code>launchd</code>, are not visible in the System Preferences, and can only be removed by the application that created them. Login items created using a shared file list are visible in System Preferences, can hide the application when it This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Additional Cloud Credentials technique in a penetration test.", "input": "Target environment: IaaS, Identity Provider, SaaS. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may add adversary-controlled credentials to a cloud account to maintain persistent access to victim accounts and instances within the environment. For example, adversaries may add credentials for Service Principals and Applications in addition to existing legitimate credentials in Azure / Entra ID. These credentials include both x509 keys and passwords. With sufficient permissions, there are a variety of ways to add credentials including the Azure Portal, Azure command line interface, and Azure or Az PowerShell modules. In infrastructure-as-a-service (IaaS) environments, after gaining access through Cloud Accounts, adversaries may generate or import their own SSH keys using either the <code>CreateKeyPair</code> or <code>ImportKeyPair</code> API in AWS or the <code>gcloud comput This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Compromise Host Software Binary technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows, ESXi. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may modify host software binaries to establish persistent access to systems. Software binaries/executables provide a wide range of system commands or services, programs, and libraries. Common software binaries are SSH clients, FTP clients, email clients, web browsers, and many other user or server applications. Adversaries may establish persistence though modifications to host software binaries. For example, an adversary may replace or otherwise infect a legitimate application binary (or support files) with a backdoor. Since these binaries may be routinely executed by applications or the user, the adversary can leverage this for persistent access to the host. An adversary may also modify a software binary such as an SSH client in order to persistently collect credentials during This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Services File Permissions Weakness technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence, privilege-escalation, defense-evasion. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may execute their own malicious payloads by hijacking the binaries used by services. Adversaries may use flaws in the permissions of Windows services to replace the binary that is executed upon service start. These service processes may automatically execute specific binaries as part of their functionality or to perform other actions. If the permissions on the file system directory containing a target binary, or permissions on the binary itself are improperly set, then the target binary may be overwritten with another binary using user-level permissions and executed by the original process. If the original process and thread are running under a higher permissions level, then the replaced binary will also execute under higher-level permissions, which could include SYSTEM. Advers This technique serves the persistence, privilege-escalation, defense-evasion phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Registry Run Keys / Startup Folder technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may achieve persistence by adding a program to a startup folder or referencing it with a Registry run key. Adding an entry to the \"run keys\" in the Registry or startup folder will cause the program referenced to be executed when a user logs in. These programs will be executed under the context of the user and will have the account's associated permissions level. The following run keys are created by default on Windows systems: * <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> * <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code> * <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code> * <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code> Run keys may exist under multip This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Cloud Account technique in a penetration test.", "input": "Target environment: IaaS, SaaS, Office Suite, Identity Provider. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may create a cloud account to maintain access to victim systems. With a sufficient level of access, such accounts may be used to establish secondary credentialed access that does not require persistent remote access tools to be deployed on the system. In addition to user accounts, cloud accounts may be associated with services. Cloud providers handle the concept of service accounts in different ways. In Azure, service accounts include service principals and managed identities, which can be linked to various resources such as OAuth applications, serverless functions, and virtual machines in order to grant those resources permissions to perform various activities in the environment. In GCP, service accounts can also be linked to specific resources, as well as be impersonated by o This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Account Manipulation technique in a penetration test.", "input": "Target environment: Containers, ESXi, IaaS, Identity Provider, Linux, macOS, Network Devices, Office Suite, SaaS, Windows. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may manipulate accounts to maintain and/or elevate access to victim systems. Account manipulation may consist of any action that preserves or modifies adversary access to a compromised account, such as modifying credentials or permission groups. These actions could also include account activity designed to subvert security policies, such as performing iterative password updates to bypass password duration policies and preserve the life of compromised credentials. In order to create or manipulate accounts, the adversary must already have sufficient permissions on systems or the domain. However, account manipulation may also lead to privilege escalation where modifications grant access to additional roles, permissions, or higher-privileged Valid Accounts. This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Kernel Modules and Extensions technique in a penetration test.", "input": "Target environment: macOS, Linux. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may modify the kernel to automatically execute programs on system boot. Loadable Kernel Modules (LKMs) are pieces of code that can be loaded and unloaded into the kernel upon demand. They extend the functionality of the kernel without the need to reboot the system. For example, one type of module is the device driver, which allows the kernel to access hardware connected to the system. When used maliciously, LKMs can be a type of kernel-mode Rootkit that run with the highest operating system privilege (Ring 0). Common features of LKM based rootkits include: hiding itself, selective hiding of files, processes and network activity, as well as log tampering, providing authenticated backdoors, and enabling root access to non-privileged users. Kernel extensions, also called kext, are This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of KernelCallbackTable technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence, privilege-escalation, defense-evasion. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse the <code>KernelCallbackTable</code> of a process to hijack its execution flow in order to run their own payloads. The <code>KernelCallbackTable</code> can be found in the Process Environment Block (PEB) and is initialized to an array of graphic functions available to a GUI process once <code>user32.dll</code> is loaded. An adversary may hijack the execution flow of a process using the <code>KernelCallbackTable</code> by replacing an original callback function with a malicious payload. Modifying callback functions can be achieved in various ways involving related behaviors such as Reflective Code Loading or Process Injection into another process. A pointer to the memory address of the <code>KernelCallbackTable</code> can be obtained by locating the PEB (ex: via a call This technique serves the persistence, privilege-escalation, defense-evasion phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Outlook Forms technique in a penetration test.", "input": "Target environment: Windows, Office Suite. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse Microsoft Outlook forms to obtain persistence on a compromised system. Outlook forms are used as templates for presentation and functionality in Outlook messages. Custom Outlook forms can be created that will execute code when a specifically crafted email is sent by an adversary utilizing the same custom Outlook form. Once malicious forms have been added to the user\u2019s mailbox, they will be loaded when Outlook is started. Malicious forms will execute when an adversary sends a specifically crafted email to the user. This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Hijack Execution Flow technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: persistence, privilege-escalation, defense-evasion. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may execute their own malicious payloads by hijacking the way operating systems run programs. Hijacking execution flow can be for the purposes of persistence, since this hijacked execution may reoccur over time. Adversaries may also use these mechanisms to elevate privileges or evade defenses, such as application control or other restrictions on execution. There are many ways an adversary may hijack the flow of execution, including by manipulating how the operating system locates programs to be executed. How the operating system locates libraries to be used by a program can also be intercepted. Locations where the operating system looks for programs/resources, such as file directories and in the case of Windows the Registry, could also be poisoned to include malicious payloads. This technique serves the persistence, privilege-escalation, defense-evasion phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Container Service technique in a penetration test.", "input": "Target environment: Containers. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may create or modify container or container cluster management tools that run as daemons, agents, or services on individual hosts. These include software for creating and managing individual containers, such as Docker and Podman, as well as container cluster node-level agents such as kubelet. By modifying these services, an adversary may be able to achieve persistence or escalate their privileges on a host. For example, by using the or command with the directive, a container can be configured to persistently restart on the host. A user with access to the (rootful) docker command may also be able to escalate their privileges on the host. In Kubernetes environments, DaemonSets allow an adversary to persistently Deploy Containers on all nodes, including ones added later to the clu This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of IIS Components technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may install malicious components that run on Internet Information Services (IIS) web servers to establish persistence. IIS provides several mechanisms to extend the functionality of the web servers. For example, Internet Server Application Programming Interface (ISAPI) extensions and filters can be installed to examine and/or modify incoming and outgoing IIS web requests. Extensions and filters are deployed as DLL files that export three functions: <code>Get{Extension/Filter}Version</code>, <code>Http{Extension/Filter}Proc</code>, and (optionally) <code>Terminate{Extension/Filter}</code>. IIS modules may also be installed to extend IIS web servers. Adversaries may install malicious ISAPI extensions and filters to observe and/or modify traffic, execute commands on compromised ma This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Authentication Package technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse authentication packages to execute DLLs when the system boots. Windows authentication package DLLs are loaded by the Local Security Authority (LSA) process at system start. They provide support for multiple logon processes and multiple security protocols to the operating system. Adversaries can use the autostart mechanism provided by LSA authentication packages for persistence by placing a reference to a binary in the Windows Registry location <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\</code> with the key value of <code>\"Authentication Packages\"=&lt;target binary&gt;</code>. The binary will then be executed by the system when the authentication packages are loaded. This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Outlook Home Page technique in a penetration test.", "input": "Target environment: Windows, Office Suite. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse Microsoft Outlook's Home Page feature to obtain persistence on a compromised system. Outlook Home Page is a legacy feature used to customize the presentation of Outlook folders. This feature allows for an internal or external URL to be loaded and presented whenever a folder is opened. A malicious HTML page can be crafted that will execute code when loaded by Outlook Home Page. Once malicious home pages have been added to the user\u2019s mailbox, they will be loaded when Outlook is started. Malicious Home Pages will execute when the right Outlook folder is loaded/reloaded. This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Path Interception by Unquoted Path technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence, privilege-escalation, defense-evasion. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may execute their own malicious payloads by hijacking vulnerable file path references. Adversaries can take advantage of paths that lack surrounding quotations by placing an executable in a higher level directory within the path, so that Windows will choose the adversary's executable to launch. Service paths and shortcut paths may also be vulnerable to path interception if the path has one or more spaces and is not surrounded by quotation marks (e.g., <code>C:\\unsafe path with space\\program.exe</code> vs. <code>\"C:\\safe path with space\\program.exe\"</code>). (stored in Windows Registry keys) An adversary can place an executable in a higher level directory of the path, and Windows will resolve that executable instead of the intended executable. For example, if the path in a short This technique serves the persistence, privilege-escalation, defense-evasion phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Startup Items technique in a penetration test.", "input": "Target environment: macOS. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use startup items automatically executed at boot initialization to establish persistence. Startup items execute during the final phase of the boot process and contain shell scripts or other executable files along with configuration information used by the system to determine the execution order for all startup items. This is technically a deprecated technology (superseded by Launch Daemon), and thus the appropriate folder, <code>/Library/StartupItems</code> isn\u2019t guaranteed to exist on the system by default, but does appear to exist by default on macOS Sierra. A startup item is a directory whose executable and configuration property list (plist), <code>StartupParameters.plist</code>, reside in the top-level directory. An adversary can create the appropriate folders/files in This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Cloud Application Integration technique in a penetration test.", "input": "Target environment: Office Suite, SaaS. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may achieve persistence by leveraging OAuth application integrations in a software-as-a-service environment. Adversaries may create a custom application, add a legitimate application into the environment, or even co-opt an existing integration to achieve malicious ends. OAuth is an open standard that allows users to authorize applications to access their information on their behalf. In a SaaS environment such as Microsoft 365 or Google Workspace, users may integrate applications to improve their workflow and achieve tasks. Leveraging application integrations may allow adversaries to persist in an environment \u2013 for example, by granting consent to an application from a high-privileged adversary-controlled account in order to maintain access to its data, even in the event of losin This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Python Startup Hooks technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may achieve persistence by leveraging Python\u2019s startup mechanisms, including path configuration () files and the or modules. These files are automatically processed during the initialization of the Python interpreter, allowing for the execution of arbitrary code whenever Python is invoked. Path configuration files are designed to extend Python\u2019s module search paths through the use of import statements. If a file is placed in Python's or directories, any lines beginning with will be executed automatically on Python invocation. Similarly, if or is present in the Python path, these files will be imported during interpreter startup, and any code they contain will be executed. Adversaries may abuse these mechanisms to establish persistence on systems where Python is widely used (e.g This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Network Logon Script technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use network logon scripts automatically executed at logon initialization to establish persistence. Network logon scripts can be assigned using Active Directory or Group Policy Objects. These logon scripts run with the privileges of the user they are assigned to. Depending on the systems within the network, initializing one of these scripts could apply to more than one or potentially all systems. Adversaries may use these scripts to maintain persistence on a network. Depending on the access configuration of the logon scripts, either local credentials or an administrator account may be necessary. This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Launch Agent technique in a penetration test.", "input": "Target environment: macOS. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may create or modify launch agents to repeatedly execute malicious payloads as part of persistence. When a user logs in, a per-user launchd process is started which loads the parameters for each launch-on-demand user agent from the property list (.plist) file found in <code>/System/Library/LaunchAgents</code>, <code>/Library/LaunchAgents</code>, and <code>~/Library/LaunchAgents</code>. Property list files use the <code>Label</code>, <code>ProgramArguments </code>, and <code>RunAtLoad</code> keys to identify the Launch Agent's name, executable location, and execution time. Launch Agents are often installed to perform updates to programs, launch user specified programs at login, or to conduct other developer tasks. Launch Agents can also be executed using the Launchctl command. A This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Server Software Component technique in a penetration test.", "input": "Target environment: Windows, Linux, macOS, Network Devices, ESXi. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse legitimate extensible development features of servers to establish persistent access to systems. Enterprise server applications may include features that allow developers to write and install software or scripts to extend the functionality of the main application. Adversaries may install malicious components to extend and abuse server applications. This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of RC Scripts technique in a penetration test.", "input": "Target environment: macOS, Linux, Network Devices, ESXi. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may establish persistence by modifying RC scripts, which are executed during a Unix-like system\u2019s startup. These files allow system administrators to map and start custom services at startup for different run levels. RC scripts require root privileges to modify. Adversaries may establish persistence by adding a malicious binary path or shell commands to <code>rc.local</code>, <code>rc.common</code>, and other RC scripts specific to the Unix-like distribution. Upon reboot, the system executes the script's contents as root, resulting in persistence. Adversary abuse of RC scripts is especially effective for lightweight Unix-like distributions using the root user as default, such as ESXi hypervisors, IoT, or embedded systems. As ESXi servers store most system files in memory and th This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Systemd Service technique in a penetration test.", "input": "Target environment: Linux. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may create or modify systemd services to repeatedly execute malicious payloads as part of persistence. Systemd is a system and service manager commonly used for managing background daemon processes (also known as services) and other system resources. Systemd is the default initialization (init) system on many Linux distributions replacing legacy init systems, including SysVinit and Upstart, while remaining backwards compatible. Systemd utilizes unit configuration files with the file extension to encode information about a service's process. By default, system level unit files are stored in the directory of the root owned directories (). User level unit files are stored in the directories of the user owned directories (). Inside the unit files, the following directives are used  This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Exclusive Control technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries who successfully compromise a system may attempt to maintain persistence by \u201cclosing the door\u201d behind them \u2013 in other words, by preventing other threat actors from initially accessing or maintaining a foothold on the same system. For example, adversaries may patch a vulnerable, compromised system to prevent other threat actors from leveraging that vulnerability in the future. They may \u201cclose the door\u201d in other ways, such as disabling vulnerable services, stripping privileges from accounts, or removing other malware already on the compromised device. Hindering other threat actors may allow an adversary to maintain sole access to a compromised system or network. This prevents the threat actor from needing to compete with or even being removed themselves by other threat actors. It This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Create Account technique in a penetration test.", "input": "Target environment: Windows, IaaS, Linux, macOS, Network Devices, Containers, SaaS, Office Suite, Identity Provider, ESXi. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may create an account to maintain access to victim systems. With a sufficient level of access, creating such accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system. Accounts may be created on the local system or within a domain or cloud tenant. In cloud environments, adversaries may create accounts that only have access to specific services, which can reduce the chance of detection. This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of XDG Autostart Entries technique in a penetration test.", "input": "Target environment: Linux. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may add or modify XDG Autostart Entries to execute malicious programs or commands when a user\u2019s desktop environment is loaded at login. XDG Autostart entries are available for any XDG-compliant Linux system. XDG Autostart entries use Desktop Entry files () to configure the user\u2019s desktop environment upon user login. These configuration files determine what applications launch upon user login, define associated applications to open specific file types, and define applications used to open removable media. Adversaries may abuse this feature to establish persistence by adding a path to a malicious binary or command to the directive in the configuration file. When the user\u2019s desktop environment is loaded at user login, the files located in the XDG Autostart directories are automati This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Re-opened Applications technique in a penetration test.", "input": "Target environment: macOS. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may modify plist files to automatically run an application when a user logs in. When a user logs out or restarts via the macOS Graphical User Interface (GUI), a prompt is provided to the user with a checkbox to \"Reopen windows when logging back in\". When selected, all applications currently open are added to a property list file named <code>com.apple.loginwindow.[UUID].plist</code> within the <code>~/Library/Preferences/ByHost</code> directory. Applications listed in this file are automatically reopened upon the user\u2019s next logon. Adversaries can establish Persistence by adding a malicious application path to the <code>com.apple.loginwindow.[UUID].plist</code> file to execute payloads when a user logs in. This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Additional Email Delegate Permissions technique in a penetration test.", "input": "Target environment: Windows, Office Suite. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may grant additional permission levels to maintain persistent access to an adversary-controlled email account. For example, the <code>Add-MailboxPermission</code> PowerShell cmdlet, available in on-premises Exchange and in the cloud-based service Office 365, adds permissions to a mailbox. In Google Workspace, delegation can be enabled via the Google Admin console and users can delegate accounts via their Gmail settings. Adversaries may also assign mailbox folder permissions through individual folder permissions or roles. In Office 365 environments, adversaries may assign the Default or Anonymous user permissions or roles to the Top of Information Store (root), Inbox, or other mailbox folders. By assigning one or both user permissions to a folder, the adversary can utilize any o This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Power Settings technique in a penetration test.", "input": "Target environment: Windows, Linux, macOS, Network Devices. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may impair a system's ability to hibernate, reboot, or shut down in order to extend access to infected machines. When a computer enters a dormant state, some or all software and hardware may cease to operate which can disrupt malicious activity. Adversaries may abuse system utilities and configuration settings to maintain access by preventing machines from entering a state, such as standby, that can terminate malicious activity. For example, controls all configurable power system settings on a Windows system and can be abused to prevent an infected host from locking or shutting down. Adversaries may also extend system lock screen timeout settings. Other relevant settings, such as disk and hibernate timeout, can be similarly abused to keep the infected machine running even if no This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Logon Script (Windows) technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use Windows logon scripts automatically executed at logon initialization to establish persistence. Windows allows logon scripts to be run whenever a specific user or group of users log into a system. This is done via adding a path to a script to the <code>HKCU\\Environment\\UserInitMprLogonScript</code> Registry key. Adversaries may use these scripts to maintain persistence on a single system. Depending on the access configuration of the logon scripts, either local credentials or an administrator account may be necessary. This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Office Test technique in a penetration test.", "input": "Target environment: Windows, Office Suite. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse the Microsoft Office \"Office Test\" Registry key to obtain persistence on a compromised system. An Office Test Registry location exists that allows a user to specify an arbitrary DLL that will be executed every time an Office application is started. This Registry key is thought to be used by Microsoft to load DLLs for testing and debugging purposes while developing Office applications. This Registry key is not created by default during an Office installation. There exist user and global Registry keys for the Office Test feature, such as: * <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Office test\\Special\\Perf</code> * <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Office test\\Special\\Perf</code> Adversaries may add this Registry key and specify a malicious DLL that will be e This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of LSASS Driver technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may modify or add LSASS drivers to obtain persistence on compromised systems. The Windows security subsystem is a set of components that manage and enforce the security policy for a computer or domain. The Local Security Authority (LSA) is the main component responsible for local security policy and user authentication. The LSA includes multiple dynamic link libraries (DLLs) associated with various other security functions, all of which run in the context of the LSA Subsystem Service (LSASS) lsass.exe process. Adversaries may target LSASS drivers to obtain persistence. By either replacing or adding illegitimate drivers (e.g., Hijack Execution Flow), an adversary can use LSA operations to continuously execute malicious payloads. This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Udev Rules technique in a penetration test.", "input": "Target environment: Linux. Attack phase: persistence, privilege-escalation. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may maintain persistence through executing malicious content triggered using udev rules. Udev is the Linux kernel device manager that dynamically manages device nodes, handles access to pseudo-device files in the directory, and responds to hardware events, such as when external devices like hard drives or keyboards are plugged in or removed. Udev uses rule files with to specify the conditions a hardware event must meet and to define the actions that should follow. Root permissions are required to create, modify, or delete rule files located in , , , , and . Rule priority is determined by both directory and by the digit prefix in the rule filename. Adversaries may abuse the udev subsystem by adding or modifying rules in udev rule files to execute malicious content. For example,  This technique serves the persistence, privilege-escalation phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of vSphere Installation Bundles technique in a penetration test.", "input": "Target environment: ESXi. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse vSphere Installation Bundles (VIBs) to establish persistent access to ESXi hypervisors. VIBs are collections of files used for software distribution and virtual system management in VMware environments. Since ESXi uses an in-memory filesystem where changes made to most files are stored in RAM rather than in persistent storage, these modifications are lost after a reboot. However, VIBs can be used to create startup tasks, apply custom firewall rules, or deploy binaries that persist across reboots. Typically, administrators use VIBs for updates and system maintenance. VIBs can be broken down into three components: * VIB payload: a archive containing the directories and files to be created and executed on boot when the VIBs are loaded. * Signature file: verifies the host This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of SQL Stored Procedures technique in a penetration test.", "input": "Target environment: Windows, Linux. Attack phase: persistence. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may abuse SQL stored procedures to establish persistent access to systems. SQL Stored Procedures are code that can be saved and reused so that database users do not waste time rewriting frequently used SQL queries. Stored procedures can be invoked via SQL statements to the database using the procedure name or via defined events (e.g. when a SQL server application is started/restarted). Adversaries may craft malicious stored procedures that can provide a persistence mechanism in SQL database servers. To execute operating system commands through SQL syntax the adversary may have to enable additional functionality, such as xp_cmdshell for MSSQL Server. Microsoft SQL Server can enable common language runtime (CLR) integration. With CLR integration enabled, application developers ca This technique serves the persistence phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Dylib Hijacking technique in a penetration test.", "input": "Target environment: macOS. Attack phase: persistence, privilege-escalation, defense-evasion. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may execute their own payloads by placing a malicious dynamic library (dylib) with an expected name in a path a victim application searches at runtime. The dynamic loader will try to find the dylibs based on the sequential order of the search paths. Paths to dylibs may be prefixed with <code>@rpath</code>, which allows developers to use relative paths to specify an array of search paths used at runtime based on the location of the executable. Additionally, if weak linking is used, such as the <code>LC_LOAD_WEAK_DYLIB</code> function, an application will still execute even if an expected dylib is not present. Weak linking enables developers to run an application on multiple macOS versions as new APIs are added. Adversaries may gain execution by inserting malicious dylibs with th This technique serves the persistence, privilege-escalation, defense-evasion phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of COR_PROFILER technique in a penetration test.", "input": "Target environment: Windows. Attack phase: persistence, privilege-escalation, defense-evasion. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may leverage the COR_PROFILER environment variable to hijack the execution flow of programs that load the .NET CLR. The COR_PROFILER is a .NET Framework feature which allows developers to specify an unmanaged (or external of .NET) profiling DLL to be loaded into each .NET process that loads the Common Language Runtime (CLR). These profilers are designed to monitor, troubleshoot, and debug managed code executed by the .NET CLR. The COR_PROFILER environment variable can be set at various scopes (system, user, or process) resulting in different levels of influence. System and user-wide environment variable scopes are specified in the Registry, where a Component Object Model (COM) object can be registered as a profiler DLL. A process scope COR_PROFILER can also be created in-memory This technique serves the persistence, privilege-escalation, defense-evasion phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
