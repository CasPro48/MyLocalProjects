{"instruction": "Analyze the use of VNC technique in a penetration test.", "input": "Target environment: Linux, Windows, macOS. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use Valid Accounts to remotely control machines using Virtual Network Computing (VNC). VNC is a platform-independent desktop sharing system that uses the RFB (\u201cremote framebuffer\u201d) protocol to enable users to remotely control another computer\u2019s display by relaying the screen, mouse, and keyboard inputs over the network. VNC differs from Remote Desktop Protocol as VNC is screen-sharing software rather than resource-sharing software. By default, VNC uses the system's authentication, but it can be configured to use credentials specific to VNC. Adversaries may abuse VNC to perform malicious actions as the logged-on user such as opening documents, downloading files, and running arbitrary commands. An adversary could use VNC to remotely control and monitor a system to collect dat This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of System Owner/User Discovery technique in a penetration test.", "input": "Target environment: Linux, macOS, Network Devices, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system. They may do this, for example, by retrieving account usernames or by using OS Credential Dumping. The information may be collected in a number of different ways using other Discovery techniques, because user and username details are prevalent throughout a system and include running process ownership, file/directory ownership, session information, and system logs. Adversaries may use the information from System Owner/User Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Various utilities and commands may acqui This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Container and Resource Discovery technique in a penetration test.", "input": "Target environment: Containers. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to discover containers and other resources that are available within a containers environment. Other resources may include images, deployments, pods, nodes, and other information such as the status of a cluster. These resources can be viewed within web applications such as the Kubernetes dashboard or can be queried via the Docker and Kubernetes APIs. In Docker, logs may leak information about the environment, such as the environment\u2019s configuration, which services are available, and what cloud provider the victim may be utilizing. The discovery of these resources may inform an adversary\u2019s next steps in the environment, such as how to perform lateral movement and which methods to utilize for execution. This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Internet Connection Discovery technique in a penetration test.", "input": "Target environment: Windows, Linux, macOS, ESXi. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may check for Internet connectivity on compromised systems. This may be performed during automated discovery and can be accomplished in numerous ways such as using Ping, <code>tracert</code>, and GET requests to websites, or performing initial speed testing to confirm bandwidth. Adversaries may use the results and responses from these requests to determine if the system is capable of communicating with their C2 servers before attempting to connect to them. The results may also be used to identify routes, redirectors, and proxy servers. This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Permission Groups Discovery technique in a penetration test.", "input": "Target environment: Containers, IaaS, Identity Provider, Linux, macOS, Office Suite, SaaS, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to discover group and permission settings. This information can help adversaries determine which user accounts and groups are available, the membership of users in particular groups, and which users and groups have elevated permissions. Adversaries may attempt to discover group permission settings in many different ways. This data may provide the adversary with information about the compromised environment that can be used in follow-on activity and targeting. This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Cloud Groups technique in a penetration test.", "input": "Target environment: SaaS, IaaS, Office Suite, Identity Provider. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to find cloud groups and permission settings. The knowledge of cloud permission groups can help adversaries determine the particular roles of users and groups within an environment, as well as which users are associated with a particular group. With authenticated access there are several tools that can be used to find permissions groups. The <code>Get-MsolRole</code> PowerShell cmdlet can be used to obtain roles and permissions groups for Exchange and Office 365 accounts . Azure CLI (AZ CLI) and the Google Cloud Identity Provider API also provide interfaces to obtain permissions groups. The command <code>az ad user get-member-groups</code> will list groups associated to a user account for Azure while the API endpoint <code>GET https://cloudidentity.googleapis.com/v1 This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Group Policy Discovery technique in a penetration test.", "input": "Target environment: Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may gather information on Group Policy settings to identify paths for privilege escalation, security measures applied within a domain, and to discover patterns in domain objects that can be manipulated or used to blend in the environment. Group Policy allows for centralized management of user and computer settings in Active Directory (AD). Group policy objects (GPOs) are containers for group policy settings made up of files stored within a predictable network path . Adversaries may use commands such as <code>gpresult</code> or various publicly available PowerShell functions, such as <code>Get-DomainGPO</code> and <code>Get-DomainGPOLocalGroup</code>, to gather information on Group Policy settings. Adversaries may use this information to shape follow-on behaviors, including dete This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Device Driver Discovery technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to enumerate local device drivers on a victim host. Information about device drivers may highlight various insights that shape follow-on behaviors, such as the function/purpose of the host, present security tools (i.e. Security Software Discovery) or other defenses (e.g., Virtualization/Sandbox Evasion), as well as potential exploitable vulnerabilities (e.g., Exploitation for Privilege Escalation). Many OS utilities may provide information about local device drivers, such as and the API function on Windows. Information about device drivers (as well as associated services, i.e., System Service Discovery) may also be available in the Registry. On Linux/macOS, device drivers (in the form of kernel modules) may be visible within or using utilities such as and . This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Domain Account technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to get a listing of domain accounts. This information can help adversaries determine which domain accounts exist to aid in follow-on behavior such as targeting specific accounts which possess particular privileges. Commands such as <code>net user /domain</code> and <code>net group /domain</code> of the Net utility, <code>dscacheutil -q group</code> on macOS, and <code>ldapsearch</code> on Linux can list domain users and groups. PowerShell cmdlets including <code>Get-ADUser</code> and <code>Get-ADGroupMember</code> may enumerate members of Active Directory groups. This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Taint Shared Content technique in a penetration test.", "input": "Target environment: Windows, SaaS, Linux, macOS, Office Suite. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may deliver payloads to remote systems by adding content to shared storage locations, such as network drives or internal code repositories. Content stored on network drives or in other shared locations may be tainted by adding malicious programs, scripts, or exploit code to otherwise valid files. Once a user opens the shared tainted content, the malicious portion can be executed to run the adversary's code on a remote system. Adversaries may use tainted shared content to move laterally. A directory share pivot is a variation on this technique that uses several other techniques to propagate malware when users access a shared network directory. It uses Shortcut Modification of directory .LNK files that use Masquerading to look like the real directories, which are hidden through H This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Local Account technique in a penetration test.", "input": "Target environment: ESXi, Linux, macOS, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to get a listing of local system accounts. This information can help adversaries determine which local accounts exist on a system to aid in follow-on behavior. Commands such as <code>net user</code> and <code>net localgroup</code> of the Net utility and <code>id</code> and <code>groups</code> on macOS and Linux can list local users and groups. On Linux, local users can also be enumerated through the use of the <code>/etc/passwd</code> file. On macOS, the <code>dscl . list /Users</code> command can be used to enumerate local accounts. On ESXi servers, the command can list local user accounts. This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Domain Groups technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to find domain-level groups and permission settings. The knowledge of domain-level permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as domain administrators. Commands such as <code>net group /domain</code> of the Net utility, <code>dscacheutil -q group</code> on macOS, and <code>ldapsearch</code> on Linux can list domain-level groups. This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of SSH technique in a penetration test.", "input": "Target environment: ESXi, Linux, macOS. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use Valid Accounts to log into remote machines using Secure Shell (SSH). The adversary may then perform actions as the logged-on user. SSH is a protocol that allows authorized users to open remote shells on other computers. Many Linux and macOS versions come with SSH installed by default, although typically disabled until the user enables it. On ESXi, SSH can be enabled either directly on the host (e.g., via ) or via vCenter. The SSH server can be configured to use standard password authentication or public-private keypairs in lieu of or in addition to a password. In this authentication scenario, the user\u2019s public key must be in a special file on the computer running the server that lists which keypairs are allowed to login as that user (i.e., SSH Authorized Keys). This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of System Service Discovery technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may try to gather information about registered local system services. Adversaries may obtain information about services using tools as well as OS utility commands such as <code>sc query</code>, <code>tasklist /svc</code>, <code>systemctl --type=service</code>, and <code>net start</code>. Adversaries may also gather information about schedule tasks via commands such as on Windows or on Linux and macOS. Adversaries may use the information from System Service Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Network Share Discovery technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement. Networks often contain shared network drives and folders that enable users to access file directories on various systems across a network. File sharing over a Windows network occurs over the SMB protocol. Net can be used to query a remote system for available shared drives using the <code>net view \\\\\\\\remotesystem</code> command. It can also be used to query shared drives on the local system using <code>net share</code>. For macOS, the <code>sharing -l</code> command lists all shared points used for smb services. This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Peripheral Device Discovery technique in a penetration test.", "input": "Target environment: Linux, Windows, macOS. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to gather information about attached peripheral devices and components connected to a computer system. Peripheral devices could include auxiliary resources that support a variety of functionalities such as keyboards, printers, cameras, smart card readers, or removable storage. The information may be used to enhance their awareness of the system and network environment or may be used for further actions. This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of System Information Discovery technique in a penetration test.", "input": "Target environment: ESXi, IaaS, Linux, macOS, Network Devices, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use this information to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. This behavior is distinct from Local Storage Discovery which is an adversary's discovery of local drive, disks and/or volumes. Tools such as Systeminfo can be used to gather detailed system information. If running with privileged access, a breakdown of system data can be gathered through the <code>systemsetup</code> configuration tool on macOS. Adversaries may leverage a Network Device CLI on network devices to gather detailed system information (e.g. <code>show ver This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Replication Through Removable Media technique in a penetration test.", "input": "Target environment: Windows. Attack phase: lateral-movement, initial-access. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may move onto systems, possibly those on disconnected or air-gapped networks, by copying malware to removable media and taking advantage of Autorun features when the media is inserted into a system and executes. In the case of Lateral Movement, this may occur through modification of executable files stored on removable media or by copying malware and renaming it to look like a legitimate file to trick users into executing it on a separate system. In the case of Initial Access, this may occur through manual manipulation of the media, modification of systems used to initially format the media, or modification to the media's firmware itself. Mobile devices may also be used to infect PCs with malware if connected via USB. This infection may be achieved using devices (Android, iOS,  This technique serves the lateral-movement, initial-access phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Direct Cloud VM Connections technique in a penetration test.", "input": "Target environment: IaaS. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may leverage Valid Accounts to log directly into accessible cloud hosted compute infrastructure through cloud native methods. Many cloud providers offer interactive connections to virtual infrastructure that can be accessed through the Cloud API, such as Azure Serial Console, AWS EC2 Instance Connect, and AWS System Manager.. Methods of authentication for these connections can include passwords, application access tokens, or SSH keys. These cloud native methods may, by default, allow for privileged access on the host with SYSTEM or root level access. Adversaries may utilize these cloud native methods to directly access virtual infrastructure and pivot through an environment. These connections typically provide direct console access to the VM rather than the execution of scripts This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Wi-Fi Discovery technique in a penetration test.", "input": "Target environment: Linux, Windows, macOS. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may search for information about Wi-Fi networks, such as network names and passwords, on compromised systems. Adversaries may use Wi-Fi information as part of Account Discovery, Remote System Discovery, and other discovery or Credential Access activity to support both ongoing and future campaigns. Adversaries may collect various types of information about Wi-Fi networks from hosts. For example, on Windows names and passwords of all Wi-Fi networks a device has previously connected to may be available through to enumerate Wi-Fi names and then to show a Wi-Fi network\u2019s corresponding password. Additionally, names and other details of locally reachable Wi-Fi networks can be discovered using calls to Native API functions. On Linux, names and passwords of all Wi-Fi-networks a device h This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Backup Software Discovery technique in a penetration test.", "input": "Target environment: Windows, macOS, Linux. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to get a listing of backup software or configurations that are installed on a system. Adversaries may use this information to shape follow-on behaviors, such as Data Destruction, Inhibit System Recovery, or Data Encrypted for Impact. Commands that can be used to obtain security software information are netsh, with Reg, with cmd, and Tasklist, but other indicators of discovery behavior may be more specific to the type of software or security system the adversary is looking for, such as Veeam, Acronis, Dropbox, or Paragon. This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Application Window Discovery technique in a penetration test.", "input": "Target environment: Linux, Windows, macOS. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to get a listing of open application windows. Window listings could convey information about how the system is used. For example, information about application windows could be used identify potential data to collect as well as identifying security tooling (Security Software Discovery) to evade. Adversaries typically abuse system features for this type of enumeration. For example, they may gather information through native system features such as Command and Scripting Interpreter commands and Native API functions. This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Email Account technique in a penetration test.", "input": "Target environment: Windows, Office Suite. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to get a listing of email addresses and accounts. Adversaries may try to dump Exchange address lists such as global address lists (GALs). In on-premises Exchange and Exchange Online, the <code>Get-GlobalAddressList</code> PowerShell cmdlet can be used to obtain email addresses and accounts from a domain using an authenticated session. In Google Workspace, the GAL is shared with Microsoft Outlook users through the Google Workspace Sync for Microsoft Outlook (GWSMO) service. Additionally, the Google Workspace Directory allows for users to get a listing of other users within the organization. This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of SSH Hijacking technique in a penetration test.", "input": "Target environment: Linux, macOS. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may hijack a legitimate user's SSH session to move laterally within an environment. Secure Shell (SSH) is a standard means of remote access on Linux and macOS systems. It allows a user to connect to another system via an encrypted tunnel, commonly authenticating through a password, certificate or the use of an asymmetric encryption key pair. In order to move laterally from a compromised host, adversaries may take advantage of trust relationships established with other systems via public key authentication in active SSH sessions by hijacking an existing connection to another system. This may occur through compromising the SSH agent itself or by having access to the agent's socket. If an adversary is able to obtain root access, then hijacking SSH sessions is likely trivial. SSH H This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of SMB/Windows Admin Shares technique in a penetration test.", "input": "Target environment: Windows. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use Valid Accounts to interact with a remote network share using Server Message Block (SMB). The adversary may then perform actions as the logged-on user. SMB is a file, printer, and serial port sharing protocol for Windows machines on the same network or domain. Adversaries may use SMB to interact with file shares, allowing them to move laterally throughout a network. Linux and macOS implementations of SMB typically use Samba. Windows systems have hidden network shares that are accessible only to administrators and provide the ability for remote file copy and other administrative functions. Example network shares include , , and . Adversaries may use this technique in conjunction with administrator-level Valid Accounts to remotely access a networked system over SMB, to int This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Remote Services technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows, IaaS, ESXi. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use Valid Accounts to log into a service that accepts remote connections, such as telnet, SSH, and VNC. The adversary may then perform actions as the logged-on user. In an enterprise environment, servers and workstations can be organized into domains. Domains provide centralized identity management, allowing users to login using one set of credentials across the entire network. If an adversary is able to obtain a set of valid domain credentials, they could login to many different machines using remote access protocols such as secure shell (SSH) or remote desktop protocol (RDP). They could also login to accessible SaaS or IaaS services, such as those that federate their identities to the domain, or management platforms for internal virtualization environments such as VMware  This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Cloud Infrastructure Discovery technique in a penetration test.", "input": "Target environment: IaaS. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: An adversary may attempt to discover infrastructure and resources that are available within an infrastructure-as-a-service (IaaS) environment. This includes compute service resources such as instances, virtual machines, and snapshots as well as resources of other services including the storage and database services. Cloud providers offer methods such as APIs and commands issued through CLIs to serve information about infrastructure. For example, AWS provides a <code>DescribeInstances</code> API within the Amazon EC2 API that can return information about one or more instances within an account, the <code>ListBuckets</code> API that returns a list of all buckets owned by the authenticated sender of the request, the <code>HeadBucket</code> API to determine a bucket\u2019s existence along with acce This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Remote Service Session Hijacking technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may take control of preexisting sessions with remote services to move laterally in an environment. Users may use valid credentials to log into a service specifically designed to accept remote connections, such as telnet, SSH, and RDP. When a user logs into a service, a session will be established that will allow them to maintain a continuous interaction with that service. Adversaries may commandeer these sessions to carry out actions on remote systems. Remote Service Session Hijacking differs from use of Remote Services because it hijacks an existing session rather than creating a new session using Valid Accounts. This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Browser Information Discovery technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may enumerate information about browsers to learn more about compromised environments. Data saved by browsers (such as bookmarks, accounts, and browsing history) may reveal a variety of personal information about users (e.g., banking sites, relationships/interests, social media, etc.) as well as details about internal network resources such as servers, tools/dashboards, or other related infrastructure. Browser information may also highlight additional targets after an adversary has access to valid credentials, especially Credentials In Files associated with logins cached by a browser. Specific storage locations vary based on platform and/or application, but browser information is typically stored in local files and databases (e.g., ). This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Windows Remote Management technique in a penetration test.", "input": "Target environment: Windows. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use Valid Accounts to interact with remote systems using Windows Remote Management (WinRM). The adversary may then perform actions as the logged-on user. WinRM is the name of both a Windows service and a protocol that allows a user to interact with a remote system (e.g., run an executable, modify the Registry, modify services). It may be called with the command or by any number of programs such as PowerShell. WinRM can be used as a method of remotely interacting with Windows Management Instrumentation. This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Distributed Component Object Model technique in a penetration test.", "input": "Target environment: Windows. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use Valid Accounts to interact with remote machines by taking advantage of Distributed Component Object Model (DCOM). The adversary may then perform actions as the logged-on user. The Windows Component Object Model (COM) is a component of the native Windows application programming interface (API) that enables interaction between software objects, or executable code that implements one or more interfaces. Through COM, a client object can call methods of server objects, which are typically Dynamic Link Libraries (DLL) or executables (EXE). Distributed COM (DCOM) is transparent middleware that extends the functionality of COM beyond a local computer using remote procedure call (RPC) technology. Permissions to interact with local and remote server COM objects are specified by a This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Virtual Machine Discovery technique in a penetration test.", "input": "Target environment: ESXi, Linux, macOS, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: An adversary may attempt to enumerate running virtual machines (VMs) after gaining access to a host or hypervisor. For example, adversaries may enumerate a list of VMs on an ESXi hypervisor using a Hypervisor CLI such as or (e.g. ). Adversaries may also directly leverage a graphical user interface, such as VMware vCenter, in order to view virtual machines on a host. Adversaries may use the information from Virtual Machine Discovery during discovery to shape follow-on behaviors. Subsequently discovered VMs may be leveraged for follow-on activities such as Service Stop or Data Encrypted for Impact. This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of System Network Configuration Discovery technique in a penetration test.", "input": "Target environment: ESXi, Linux, macOS, Network Devices, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may look for details about the network configuration and settings, such as IP and/or MAC addresses, of systems they access or through information discovery of remote systems. Several operating system administration utilities exist that can be used to gather this information. Examples include Arp, ipconfig/ifconfig, nbtstat, and route. Adversaries may also leverage a Network Device CLI on network devices to gather information about configurations and settings, such as IP addresses of configured interfaces and static/dynamic routes (e.g. <code>show ip route</code>, <code>show ip interface</code>). On ESXi, adversaries may leverage esxcli to gather network configuration information. For example, the command will retrieve the MAC address, while will retrieve the local IPv4 address. This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Account Discovery technique in a penetration test.", "input": "Target environment: ESXi, IaaS, Identity Provider, Linux, macOS, Office Suite, SaaS, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to get a listing of valid accounts, usernames, or email addresses on a system or within a compromised environment. This information can help adversaries determine which accounts exist, which can aid in follow-on behavior such as brute-forcing, spear-phishing attacks, or account takeovers (e.g., Valid Accounts). Adversaries may use several methods to enumerate accounts, including abuse of existing tools, built-in commands, and potential misconfigurations that leak account names and roles or permissions in the targeted environment. For examples, cloud environments typically provide easily accessible interfaces to obtain user lists. On hosts, adversaries can use default PowerShell and other command line functionality to identify accounts. Information about email addres This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Domain Trust Discovery technique in a penetration test.", "input": "Target environment: Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to gather information on domain trust relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments. Domain trusts provide a mechanism for a domain to allow access to resources based on the authentication procedures of another domain. Domain trusts allow the users of the trusted domain to access resources in the trusting domain. The information discovered may help the adversary conduct SID-History Injection, Pass the Ticket, and Kerberoasting. Domain trusts can be enumerated using the Win32 API call, .NET methods, and LDAP. The Windows utility Nltest is known to be used by adversaries to enumerate domain trusts. This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of File and Directory Discovery technique in a penetration test.", "input": "Target environment: ESXi, Linux, macOS, Network Devices, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system. Adversaries may use the information from File and Directory Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Many command shell utilities can be used to obtain this information. Examples include <code>dir</code>, <code>tree</code>, <code>ls</code>, <code>find</code>, and <code>locate</code>. Custom tools may also be used to gather file and directory information and interact with the Native API. Adversaries may also leverage a Network Device CLI on network devices to gather file and directory information (e.g. <code>dir</c This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of System Network Connections Discovery technique in a penetration test.", "input": "Target environment: Windows, IaaS, Linux, macOS, Network Devices, ESXi. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network. An adversary who gains access to a system that is part of a cloud-based environment may map out Virtual Private Clouds or Virtual Networks in order to determine what systems and services are connected. The actions performed are likely the same types of discovery techniques depending on the operating system, but the resulting information may include details about the networked cloud environment relevant to the adversary's goals. Cloud providers may have different ways in which their virtual networks operate. Similarly, adversaries who gain access to network devices may also perform similar discover This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Cloud Storage Object Discovery technique in a penetration test.", "input": "Target environment: IaaS. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may enumerate objects in cloud storage infrastructure. Adversaries may use this information during automated discovery to shape follow-on behaviors, including requesting all or specific objects from cloud storage. Similar to File and Directory Discovery on a local host, after identifying available storage services (i.e. Cloud Infrastructure Discovery) adversaries may access the contents/objects stored in cloud infrastructure. Cloud service providers offer APIs allowing users to enumerate objects stored within cloud storage. Examples include ListObjectsV2 in AWS and List Blobs in Azure . This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Log Enumeration technique in a penetration test.", "input": "Target environment: ESXi, IaaS, Linux, macOS, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may enumerate system and service logs to find useful data. These logs may highlight various types of valuable insights for an adversary, such as user authentication records (Account Discovery), security or vulnerable software (Software Discovery), or hosts within a compromised network (Remote System Discovery). Host binaries may be leveraged to collect system logs. Examples include using or PowerShell on Windows to access and/or export security event information. In cloud environments, adversaries may leverage utilities such as the Azure VM Agent\u2019s to collect security logs from cloud hosted infrastructure. Adversaries may also target centralized logging infrastructure such as SIEMs. Logs may also be bulk exported and sent to adversary-controlled infrastructure for offline analy This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Cloud Services technique in a penetration test.", "input": "Target environment: IaaS, Identity Provider, Office Suite, SaaS. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may log into accessible cloud services within a compromised environment using Valid Accounts that are synchronized with or federated to on-premises user identities. The adversary may then perform management actions or access cloud-hosted resources as the logged-on user. Many enterprises federate centrally managed user identities to cloud services, allowing users to login with their domain credentials in order to access the cloud control plane. Similarly, adversaries may connect to available cloud services through the web console or through the cloud command line interface (CLI) (e.g., Cloud API), using commands such as <code>Connect-AZAccount</code> for Azure PowerShell, <code>Connect-MgGraph</code> for Microsoft Graph PowerShell, and <code>gcloud auth login</code> for the Goog This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Cloud Account technique in a penetration test.", "input": "Target environment: IaaS, Identity Provider, Office Suite, SaaS. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to get a listing of cloud accounts. Cloud accounts are those created and configured by an organization for use by users, remote support, services, or for administration of resources within a cloud service provider or SaaS application. With authenticated access there are several tools that can be used to find accounts. The <code>Get-MsolRoleMember</code> PowerShell cmdlet can be used to obtain account names given a role or permissions group in Office 365. The Azure CLI (AZ CLI) also provides an interface to obtain user accounts with authenticated access to a domain. The command <code>az ad user list</code> will list all users within a domain. The AWS command <code>aws iam list-users</code> may be used to obtain a list of users in the current account while <code>aws i This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Process Discovery technique in a penetration test.", "input": "Target environment: ESXi, Linux, macOS, Network Devices, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network. Administrator or otherwise elevated access may provide better process details. Adversaries may use the information from Process Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. In Windows environments, adversaries could obtain details on running processes using the Tasklist utility via cmd or <code>Get-Process</code> via PowerShell. Information about processes can also be extracted from the output of Native API calls such as <code>CreateToolhelp32Snapshot</code>. In Ma This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Exploitation of Remote Services technique in a penetration test.", "input": "Target environment: Linux, Windows, macOS, ESXi. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may exploit remote services to gain unauthorized access to internal systems once inside of a network. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. A common goal for post-compromise exploitation of remote services is for lateral movement to enable access to a remote system. An adversary may need to determine if the remote system is in a vulnerable state, which may be done through Network Service Discovery or other Discovery methods looking for common, vulnerable software that may be deployed in the network, the lack of certain patches that may indicate vulnerabilities, or security software that may be us This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Internal Spearphishing technique in a penetration test.", "input": "Target environment: Windows, macOS, Linux, SaaS, Office Suite. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: After they already have access to accounts or systems within the environment, adversaries may use internal spearphishing to gain access to additional information or compromise other users within the same organization. Internal spearphishing is multi-staged campaign where a legitimate account is initially compromised either by controlling the user's device or by compromising the account credentials of the user. Adversaries may then attempt to take advantage of the trusted internal account to increase the likelihood of tricking more victims into falling for phish attempts, often incorporating Impersonation. For example, adversaries may leverage Spearphishing Attachment or Spearphishing Link as part of internal spearphishing to deliver a payload or redirect to an external site to capture cred This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Local Groups technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to find local system groups and permission settings. The knowledge of local system permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as the users found within the local administrators group. Commands such as <code>net localgroup</code> of the Net utility, <code>dscl . -list /Groups</code> on macOS, and <code>groups</code> on Linux can list local groups. This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Password Policy Discovery technique in a penetration test.", "input": "Target environment: Windows, Linux, macOS, IaaS, Network Devices, Identity Provider, SaaS, Office Suite. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to access detailed information about the password policy used within an enterprise network or cloud environment. Password policies are a way to enforce complex passwords that are difficult to guess or crack through Brute Force. This information may help the adversary to create a list of common passwords and launch dictionary and/or brute force attacks which adheres to the policy (e.g. if the minimum password length should be 8, then not trying passwords such as 'pass123'; not checking for more than 3-4 passwords per account if the lockout is set to 6 as to not lock out accounts). Password policies can be set and discovered on Windows, Linux, and macOS systems via various command shell utilities such as <code>net accounts (/domain)</code>, <code>Get-ADDefaultDomainPa This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Lateral Tool Transfer technique in a penetration test.", "input": "Target environment: ESXi, Linux, macOS, Windows. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may transfer tools or other files between systems in a compromised environment. Once brought into the victim environment (i.e., Ingress Tool Transfer) files may then be copied from one system to another to stage adversary tools or other files over the course of an operation. Adversaries may copy files between internal victim systems to support lateral movement using inherent file sharing protocols such as file sharing over SMB/Windows Admin Shares to connected network shares or with authenticated connections via Remote Desktop Protocol. Files can also be transferred using native or otherwise present tools on the victim system, such as scp, rsync, curl, sftp, and ftp. In some cases, adversaries may be able to leverage Web Services such as Dropbox or OneDrive to copy files from o This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of System Language Discovery technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to gather information about the system language of a victim in order to infer the geographical location of that host. This information may be used to shape follow-on behaviors, including whether the adversary infects the target and/or attempts specific actions. This decision may be employed by malware developers and operators to reduce their risk of attracting the attention of specific law enforcement agencies or prosecution/scrutiny from other entities. There are various sources of data an adversary could use to infer system language, such as system defaults and keyboard layouts. Specific checks will vary based on the target and/or adversary, but may involve behaviors such as Query Registry and calls to Native API functions. For example, on a Windows system adversa This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Query Registry technique in a penetration test.", "input": "Target environment: Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may interact with the Windows Registry to gather information about the system, configuration, and installed software. The Registry contains a significant amount of information about the operating system, configuration, software, and security. Information can easily be queried using the Reg utility, though other means to access the Registry exist. Some of the information may help adversaries to further their operation within a network. Adversaries may use the information from Query Registry during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of System Location Discovery technique in a penetration test.", "input": "Target environment: IaaS, Linux, macOS, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may gather information in an attempt to calculate the geographical location of a victim host. Adversaries may use the information from System Location Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Adversaries may attempt to infer the location of a system using various system checks, such as time zone, keyboard layout, and/or language settings. Windows API functions such as <code>GetLocaleInfoW</code> can also be used to determine the locale of the host. In cloud environments, an instance's availability zone may also be discovered by accessing the instance metadata service from the instance. Adversaries may also attempt to infer the location of a victim host usi This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Security Software Discovery technique in a penetration test.", "input": "Target environment: IaaS, Linux, macOS, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to get a listing of security software, configurations, defensive tools, and sensors that are installed on a system or in a cloud environment. This may include things such as cloud monitoring agents and anti-virus. Adversaries may use the information from Security Software Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Example commands that can be used to obtain security software information are netsh, <code>reg query</code> with Reg, <code>dir</code> with cmd, and Tasklist, but other indicators of discovery behavior may be more specific to the type of software or security system the adversary is looking for. It is becoming more common to see macOS ma This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of RDP Hijacking technique in a penetration test.", "input": "Target environment: Windows. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may hijack a legitimate user\u2019s remote desktop session to move laterally within an environment. Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS). Adversaries may perform RDP session hijacking which involves stealing a legitimate user's remote session. Typically, a user is notified when someone else is trying to steal their session. With System permissions and using Terminal Services Console, , an adversary can hijack a session without the need for credentials or prompts to the user. This can be done remotely or locally and with active or disconnec This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Cloud Service Discovery technique in a penetration test.", "input": "Target environment: IaaS, Identity Provider, Office Suite, SaaS. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: An adversary may attempt to enumerate the cloud services running on a system after gaining access. These methods can differ from platform-as-a-service (PaaS), to infrastructure-as-a-service (IaaS), or software-as-a-service (SaaS). Many services exist throughout the various cloud providers and can include Continuous Integration and Continuous Delivery (CI/CD), Lambda Functions, Entra ID, etc. They may also include security services, such as AWS GuardDuty and Microsoft Defender for Cloud, and logging services, such as AWS CloudTrail and Google Cloud Audit Logs. Adversaries may attempt to discover information about the services enabled throughout the environment. Azure tools and APIs, such as the Microsoft Graph API and Azure Resource Manager API, can enumerate resources and services, includi This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Remote System Discovery technique in a penetration test.", "input": "Target environment: ESXi, Linux, macOS, Network Devices, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used such as Ping, <code>net view</code> using Net, or, on ESXi servers, . Adversaries may also analyze data from local host files (ex: <code>C:\\Windows\\System32\\Drivers\\etc\\hosts</code> or <code>/etc/hosts</code>) or other passive means (such as local Arp cache entries) in order to discover the presence of remote systems in an environment. Adversaries may also target discovery of network infrastructure as well as leverage Network Device CLI commands on network devices to gathe This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Network Service Discovery technique in a penetration test.", "input": "Target environment: Containers, IaaS, Linux, macOS, Network Devices, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to get a listing of services running on remote hosts and local network infrastructure devices, including those that may be vulnerable to remote software exploitation. Common methods to acquire this information include port, vulnerability, and/or wordlist scans using tools that are brought onto a system. Within cloud environments, adversaries may attempt to discover services running on other cloud hosts. Additionally, if the cloud environment is connected to a on-premises environment, adversaries may be able to identify services running on non-cloud systems as well. Within macOS environments, adversaries may use the native Bonjour application to discover services running on other macOS hosts within a network. The Bonjour mDNSResponder daemon automatically registers a This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Software Discovery technique in a penetration test.", "input": "Target environment: ESXi, IaaS, Linux, macOS, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to get a listing of software and software versions that are installed on a system or in a cloud environment. Adversaries may use the information from Software Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Such software may be deployed widely across the environment for configuration management or security reasons, such as Software Deployment Tools, and may allow adversaries broad access to infect devices or move laterally. Adversaries may attempt to enumerate software for a variety of reasons, such as figuring out what security measures are present or if the compromised system has a version of software that is vulnerable to Exploitation for Privilege This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Cloud Service Dashboard technique in a penetration test.", "input": "Target environment: IaaS, SaaS, Office Suite, Identity Provider. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: An adversary may use a cloud service dashboard GUI with stolen credentials to gain useful information from an operational cloud environment, such as specific services, resources, and features. For example, the GCP Command Center can be used to view all assets, review findings of potential security risks, and run additional queries, such as finding public IP addresses and open ports. Depending on the configuration of the environment, an adversary may be able to enumerate more information via the graphical dashboard than an API. This also allows the adversary to gain information without manually making any API requests. This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Remote Desktop Protocol technique in a penetration test.", "input": "Target environment: Windows. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user. Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS). Adversaries may connect to a remote system over RDP/RDS to expand access if the service is enabled and allows access to accounts with known credentials. Adversaries will likely use Credential Access techniques to acquire credentials to use with RDP. Adversaries may also use RDP in conjunction with the Accessibility Features or Terminal Services DLL fo This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Local Storage Discovery technique in a penetration test.", "input": "Target environment: ESXi, IaaS, Linux, macOS, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may enumerate local drives, disks, and/or volumes and their attributes like total or free space and volume serial number. This can be done to prepare for ransomware-related encryption, to perform Lateral Movement, or as a precursor to Direct Volume Access. On ESXi systems, adversaries may use Hypervisor CLI commands such as to list storage connected to the host as well as files. On Windows systems, adversaries can use to find information about local network drives. They can also use in PowerShell to retrieve drives and may additionally use Windows API functions such as . Linux has commands such as , , , , and that can list information about disk partitions such as size, type, file system types, and free space. The command on MacOS can be used to list disks while can additionall This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of System Time Discovery technique in a penetration test.", "input": "Target environment: ESXi, Linux, macOS, Network Devices, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: An adversary may gather the system time and/or time zone settings from a local or remote system. The system time is set and stored by services, such as the Windows Time Service on Windows or <code>systemsetup</code> on macOS. These time settings may also be synchronized between systems and services in an enterprise network, typically accomplished with a network time server within a domain. System time information may be gathered in a number of ways, such as with Net on Windows by performing <code>net time \\\\hostname</code> to gather the system time on a remote system. The victim's time zone may also be inferred from the current system time or gathered by using <code>w32tm /tz</code>. In addition, adversaries can discover device uptime through functions such as <code>GetTickCount()</code> t This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
