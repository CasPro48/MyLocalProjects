{"instruction": "Analyze the use of VNC technique in a penetration test.", "input": "Target environment: Linux, Windows, macOS. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use Valid Accounts to remotely control machines using Virtual Network Computing (VNC). VNC is a platform-independent desktop sharing system that uses the RFB (\u201cremote framebuffer\u201d) protocol to enable users to remotely control another computer\u2019s display by relaying the screen, mouse, and keyboard inputs over the network. VNC differs from Remote Desktop Protocol as VNC is screen-sharing software rather than resource-sharing software. By default, VNC uses the system's authentication, but it can be configured to use credentials specific to VNC. Adversaries may abuse VNC to perform malicious actions as the logged-on user such as opening documents, downloading files, and running arbitrary commands. An adversary could use VNC to remotely control and monitor a system to collect dat This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of System Owner/User Discovery technique in a penetration test.", "input": "Target environment: Linux, macOS, Network Devices, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system. They may do this, for example, by retrieving account usernames or by using OS Credential Dumping. The information may be collected in a number of different ways using other Discovery techniques, because user and username details are prevalent throughout a system and include running process ownership, file/directory ownership, session information, and system logs. Adversaries may use the information from System Owner/User Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Various utilities and commands may acqui This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Container and Resource Discovery technique in a penetration test.", "input": "Target environment: Containers. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to discover containers and other resources that are available within a containers environment. Other resources may include images, deployments, pods, nodes, and other information such as the status of a cluster. These resources can be viewed within web applications such as the Kubernetes dashboard or can be queried via the Docker and Kubernetes APIs. In Docker, logs may leak information about the environment, such as the environment\u2019s configuration, which services are available, and what cloud provider the victim may be utilizing. The discovery of these resources may inform an adversary\u2019s next steps in the environment, such as how to perform lateral movement and which methods to utilize for execution. This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Device Driver Discovery technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to enumerate local device drivers on a victim host. Information about device drivers may highlight various insights that shape follow-on behaviors, such as the function/purpose of the host, present security tools (i.e. Security Software Discovery) or other defenses (e.g., Virtualization/Sandbox Evasion), as well as potential exploitable vulnerabilities (e.g., Exploitation for Privilege Escalation). Many OS utilities may provide information about local device drivers, such as and the API function on Windows. Information about device drivers (as well as associated services, i.e., System Service Discovery) may also be available in the Registry. On Linux/macOS, device drivers (in the form of kernel modules) may be visible within or using utilities such as and . This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of SSH technique in a penetration test.", "input": "Target environment: ESXi, Linux, macOS. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use Valid Accounts to log into remote machines using Secure Shell (SSH). The adversary may then perform actions as the logged-on user. SSH is a protocol that allows authorized users to open remote shells on other computers. Many Linux and macOS versions come with SSH installed by default, although typically disabled until the user enables it. On ESXi, SSH can be enabled either directly on the host (e.g., via ) or via vCenter. The SSH server can be configured to use standard password authentication or public-private keypairs in lieu of or in addition to a password. In this authentication scenario, the user\u2019s public key must be in a special file on the computer running the server that lists which keypairs are allowed to login as that user (i.e., SSH Authorized Keys). This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Direct Cloud VM Connections technique in a penetration test.", "input": "Target environment: IaaS. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may leverage Valid Accounts to log directly into accessible cloud hosted compute infrastructure through cloud native methods. Many cloud providers offer interactive connections to virtual infrastructure that can be accessed through the Cloud API, such as Azure Serial Console, AWS EC2 Instance Connect, and AWS System Manager.. Methods of authentication for these connections can include passwords, application access tokens, or SSH keys. These cloud native methods may, by default, allow for privileged access on the host with SYSTEM or root level access. Adversaries may utilize these cloud native methods to directly access virtual infrastructure and pivot through an environment. These connections typically provide direct console access to the VM rather than the execution of scripts This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of SMB/Windows Admin Shares technique in a penetration test.", "input": "Target environment: Windows. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use Valid Accounts to interact with a remote network share using Server Message Block (SMB). The adversary may then perform actions as the logged-on user. SMB is a file, printer, and serial port sharing protocol for Windows machines on the same network or domain. Adversaries may use SMB to interact with file shares, allowing them to move laterally throughout a network. Linux and macOS implementations of SMB typically use Samba. Windows systems have hidden network shares that are accessible only to administrators and provide the ability for remote file copy and other administrative functions. Example network shares include , , and . Adversaries may use this technique in conjunction with administrator-level Valid Accounts to remotely access a networked system over SMB, to int This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Remote Services technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows, IaaS, ESXi. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use Valid Accounts to log into a service that accepts remote connections, such as telnet, SSH, and VNC. The adversary may then perform actions as the logged-on user. In an enterprise environment, servers and workstations can be organized into domains. Domains provide centralized identity management, allowing users to login using one set of credentials across the entire network. If an adversary is able to obtain a set of valid domain credentials, they could login to many different machines using remote access protocols such as secure shell (SSH) or remote desktop protocol (RDP). They could also login to accessible SaaS or IaaS services, such as those that federate their identities to the domain, or management platforms for internal virtualization environments such as VMware  This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Remote Service Session Hijacking technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may take control of preexisting sessions with remote services to move laterally in an environment. Users may use valid credentials to log into a service specifically designed to accept remote connections, such as telnet, SSH, and RDP. When a user logs into a service, a session will be established that will allow them to maintain a continuous interaction with that service. Adversaries may commandeer these sessions to carry out actions on remote systems. Remote Service Session Hijacking differs from use of Remote Services because it hijacks an existing session rather than creating a new session using Valid Accounts. This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Browser Information Discovery technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may enumerate information about browsers to learn more about compromised environments. Data saved by browsers (such as bookmarks, accounts, and browsing history) may reveal a variety of personal information about users (e.g., banking sites, relationships/interests, social media, etc.) as well as details about internal network resources such as servers, tools/dashboards, or other related infrastructure. Browser information may also highlight additional targets after an adversary has access to valid credentials, especially Credentials In Files associated with logins cached by a browser. Specific storage locations vary based on platform and/or application, but browser information is typically stored in local files and databases (e.g., ). This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Windows Remote Management technique in a penetration test.", "input": "Target environment: Windows. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use Valid Accounts to interact with remote systems using Windows Remote Management (WinRM). The adversary may then perform actions as the logged-on user. WinRM is the name of both a Windows service and a protocol that allows a user to interact with a remote system (e.g., run an executable, modify the Registry, modify services). It may be called with the command or by any number of programs such as PowerShell. WinRM can be used as a method of remotely interacting with Windows Management Instrumentation. This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Distributed Component Object Model technique in a penetration test.", "input": "Target environment: Windows. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use Valid Accounts to interact with remote machines by taking advantage of Distributed Component Object Model (DCOM). The adversary may then perform actions as the logged-on user. The Windows Component Object Model (COM) is a component of the native Windows application programming interface (API) that enables interaction between software objects, or executable code that implements one or more interfaces. Through COM, a client object can call methods of server objects, which are typically Dynamic Link Libraries (DLL) or executables (EXE). Distributed COM (DCOM) is transparent middleware that extends the functionality of COM beyond a local computer using remote procedure call (RPC) technology. Permissions to interact with local and remote server COM objects are specified by a This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Log Enumeration technique in a penetration test.", "input": "Target environment: ESXi, IaaS, Linux, macOS, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may enumerate system and service logs to find useful data. These logs may highlight various types of valuable insights for an adversary, such as user authentication records (Account Discovery), security or vulnerable software (Software Discovery), or hosts within a compromised network (Remote System Discovery). Host binaries may be leveraged to collect system logs. Examples include using or PowerShell on Windows to access and/or export security event information. In cloud environments, adversaries may leverage utilities such as the Azure VM Agent\u2019s to collect security logs from cloud hosted infrastructure. Adversaries may also target centralized logging infrastructure such as SIEMs. Logs may also be bulk exported and sent to adversary-controlled infrastructure for offline analy This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Cloud Services technique in a penetration test.", "input": "Target environment: IaaS, Identity Provider, Office Suite, SaaS. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may log into accessible cloud services within a compromised environment using Valid Accounts that are synchronized with or federated to on-premises user identities. The adversary may then perform management actions or access cloud-hosted resources as the logged-on user. Many enterprises federate centrally managed user identities to cloud services, allowing users to login with their domain credentials in order to access the cloud control plane. Similarly, adversaries may connect to available cloud services through the web console or through the cloud command line interface (CLI) (e.g., Cloud API), using commands such as <code>Connect-AZAccount</code> for Azure PowerShell, <code>Connect-MgGraph</code> for Microsoft Graph PowerShell, and <code>gcloud auth login</code> for the Goog This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Cloud Account technique in a penetration test.", "input": "Target environment: IaaS, Identity Provider, Office Suite, SaaS. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to get a listing of cloud accounts. Cloud accounts are those created and configured by an organization for use by users, remote support, services, or for administration of resources within a cloud service provider or SaaS application. With authenticated access there are several tools that can be used to find accounts. The <code>Get-MsolRoleMember</code> PowerShell cmdlet can be used to obtain account names given a role or permissions group in Office 365. The Azure CLI (AZ CLI) also provides an interface to obtain user accounts with authenticated access to a domain. The command <code>az ad user list</code> will list all users within a domain. The AWS command <code>aws iam list-users</code> may be used to obtain a list of users in the current account while <code>aws i This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Internal Spearphishing technique in a penetration test.", "input": "Target environment: Windows, macOS, Linux, SaaS, Office Suite. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: After they already have access to accounts or systems within the environment, adversaries may use internal spearphishing to gain access to additional information or compromise other users within the same organization. Internal spearphishing is multi-staged campaign where a legitimate account is initially compromised either by controlling the user's device or by compromising the account credentials of the user. Adversaries may then attempt to take advantage of the trusted internal account to increase the likelihood of tricking more victims into falling for phish attempts, often incorporating Impersonation. For example, adversaries may leverage Spearphishing Attachment or Spearphishing Link as part of internal spearphishing to deliver a payload or redirect to an external site to capture cred This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of System Language Discovery technique in a penetration test.", "input": "Target environment: Linux, macOS, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to gather information about the system language of a victim in order to infer the geographical location of that host. This information may be used to shape follow-on behaviors, including whether the adversary infects the target and/or attempts specific actions. This decision may be employed by malware developers and operators to reduce their risk of attracting the attention of specific law enforcement agencies or prosecution/scrutiny from other entities. There are various sources of data an adversary could use to infer system language, such as system defaults and keyboard layouts. Specific checks will vary based on the target and/or adversary, but may involve behaviors such as Query Registry and calls to Native API functions. For example, on a Windows system adversa This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Security Software Discovery technique in a penetration test.", "input": "Target environment: IaaS, Linux, macOS, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to get a listing of security software, configurations, defensive tools, and sensors that are installed on a system or in a cloud environment. This may include things such as cloud monitoring agents and anti-virus. Adversaries may use the information from Security Software Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. Example commands that can be used to obtain security software information are netsh, <code>reg query</code> with Reg, <code>dir</code> with cmd, and Tasklist, but other indicators of discovery behavior may be more specific to the type of software or security system the adversary is looking for. It is becoming more common to see macOS ma This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of RDP Hijacking technique in a penetration test.", "input": "Target environment: Windows. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may hijack a legitimate user\u2019s remote desktop session to move laterally within an environment. Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS). Adversaries may perform RDP session hijacking which involves stealing a legitimate user's remote session. Typically, a user is notified when someone else is trying to steal their session. With System permissions and using Terminal Services Console, , an adversary can hijack a session without the need for credentials or prompts to the user. This can be done remotely or locally and with active or disconnec This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Cloud Service Discovery technique in a penetration test.", "input": "Target environment: IaaS, Identity Provider, Office Suite, SaaS. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: An adversary may attempt to enumerate the cloud services running on a system after gaining access. These methods can differ from platform-as-a-service (PaaS), to infrastructure-as-a-service (IaaS), or software-as-a-service (SaaS). Many services exist throughout the various cloud providers and can include Continuous Integration and Continuous Delivery (CI/CD), Lambda Functions, Entra ID, etc. They may also include security services, such as AWS GuardDuty and Microsoft Defender for Cloud, and logging services, such as AWS CloudTrail and Google Cloud Audit Logs. Adversaries may attempt to discover information about the services enabled throughout the environment. Azure tools and APIs, such as the Microsoft Graph API and Azure Resource Manager API, can enumerate resources and services, includi This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Remote System Discovery technique in a penetration test.", "input": "Target environment: ESXi, Linux, macOS, Network Devices, Windows. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used such as Ping, <code>net view</code> using Net, or, on ESXi servers, . Adversaries may also analyze data from local host files (ex: <code>C:\\Windows\\System32\\Drivers\\etc\\hosts</code> or <code>/etc/hosts</code>) or other passive means (such as local Arp cache entries) in order to discover the presence of remote systems in an environment. Adversaries may also target discovery of network infrastructure as well as leverage Network Device CLI commands on network devices to gathe This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Cloud Service Dashboard technique in a penetration test.", "input": "Target environment: IaaS, SaaS, Office Suite, Identity Provider. Attack phase: discovery. Assume standard enterprise security controls are in place.", "output": "Technique overview: An adversary may use a cloud service dashboard GUI with stolen credentials to gain useful information from an operational cloud environment, such as specific services, resources, and features. For example, the GCP Command Center can be used to view all assets, review findings of potential security risks, and run additional queries, such as finding public IP addresses and open ports. Depending on the configuration of the environment, an adversary may be able to enumerate more information via the graphical dashboard than an API. This also allows the adversary to gain information without manually making any API requests. This technique serves the discovery phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Analyze the use of Remote Desktop Protocol technique in a penetration test.", "input": "Target environment: Windows. Attack phase: lateral-movement. Assume standard enterprise security controls are in place.", "output": "Technique overview: Adversaries may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user. Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS). Adversaries may connect to a remote system over RDP/RDS to expand access if the service is enabled and allows access to accounts with known credentials. Adversaries will likely use Credential Access techniques to acquire credentials to use with RDP. Adversaries may also use RDP in conjunction with the Accessibility Features or Terminal Services DLL fo This technique serves the lateral-movement phase(s). Consider sequencing with complementary techniques for a complete attack chain."}
{"instruction": "Plan lateral movement in an Active Directory environment.", "input": "You have local admin on one workstation. Target is file server with sensitive data. LAPS deployed, network segmented.", "output": "LAPS complicates credential reuse - each machine has unique local admin password. Strategy shift required: 1) Check if current user has RDP/admin rights on other machines via group membership. 2) Look for domain cached credentials that might work elsewhere. 3) Identify service accounts - these often have broader access than user accounts. 4) Check for over-permissioned shares accessible from current context. Avoid: Trying local admin creds on other machines (will fail with LAPS). Instead: Focus on domain-level access paths. Use BloodHound data to map shortest path to file server. Consider: Kerberos delegation abuse if service accounts are found."}
{"instruction": "You need to move laterally but PSRemoting is disabled.", "input": "Domain user credentials, target Windows server, WinRM blocked, SMB accessible, EDR present.", "output": "Without PSRemoting, lateral movement options: 1) SMB + scheduled task creation (schtasks) - creates task that runs as SYSTEM. 2) SMB + service creation (sc.exe) - more detectable but reliable. 3) WMI over DCOM - uses port 135 + dynamic ports. 4) PsExec-style named pipe execution. EDR considerations: Scheduled tasks and service creation are monitored but common. Use legitimate-looking task names. WMI is often less monitored than service creation. Recommended: WMI execution if DCOM is available, otherwise scheduled task with cleanup. Always delete artifacts after execution."}
{"instruction": "Move laterally in a Linux environment.", "input": "SSH access to web server, need to reach database server in internal network. No direct SSH access to DB.", "output": "Linux lateral movement typically via: 1) SSH key harvesting - check ~/.ssh/ for private keys, known_hosts for targets. 2) Credential reuse - check bash_history, config files, environment variables for passwords. 3) SSH agent hijacking - if agent forwarding enabled, abuse existing sessions. 4) Network pivoting - use compromised host as jump point. For reaching internal DB: Set up SSH tunnel (ssh -L) or SOCKS proxy (ssh -D). Check if web app has database credentials in config files (/var/www/, .env files). Recommended: Harvest credentials from web app config > attempt direct DB connection > pivot via SSH tunnel if needed."}
{"instruction": "Lateral movement in a cloud-hybrid environment.", "input": "Compromised on-prem workstation, Azure AD joined. Need to access Azure resources.", "output": "Azure AD join creates interesting pivot opportunities: 1) Check for Primary Refresh Token (PRT) - can be used to access Azure resources. 2) Look for Azure CLI/PowerShell cached credentials (~/.azure/, %USERPROFILE%\\.azure). 3) Managed Identity on the machine may have Azure permissions. 4) Check browser for cached Azure portal sessions. Tools: ROADtools for Azure AD enumeration, AADInternals for token manipulation. If PRT extraction successful, can access Azure as the user without password. Detection: Azure AD sign-in logs will show access - use existing session tokens to blend with normal activity."}
{"instruction": "Plan stealthy lateral movement with heavy monitoring.", "input": "SOC is active, SIEM collecting logs, need to move from DMZ to internal network.", "output": "Heavy monitoring requires living-off-the-land approach: 1) Use legitimate admin tools already present (RSAT, built-in Windows tools). 2) Move during business hours to blend with normal traffic. 3) Avoid mass scanning - single targeted connections only. 4) Use existing service accounts if compromised - their activity patterns are expected. For DMZ to internal: Identify legitimate data flows (backup, management traffic) and mimic them. Check for jump hosts or bastion servers that are expected to connect internally. Timing: Avoid moving immediately after initial access - let activity baseline normalize. Consider: DNS tunneling or HTTPS-based C2 that looks like normal web traffic."}
